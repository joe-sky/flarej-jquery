FJ.define("widget.ProgressBar",function(){var d,c,a=d=c=this.flareJ,b=this.jQuery;this.ProgressBarJ=this.PBJ=d.ProgressBarJ=d.PBJ=d.CJ.extend({init:function(e,f){this._super(e,b.extend(true,{fjType:"PBJ",renderTo:e,width:200,height:18,value:30,valueMsg:"{0}%",max:100,radius:5,borderWidth:0,borderP:1,hideTxt:false,autoRise:20,autoDelay:500,hasTxt:true,colorParams:{borderOut:null,bgColor:"#fff"},evts:{progressChanged:null}},f));this.initFn();return this},initFn:function(){this.valueMsgTmp=this.p.valueMsg;this._super();this.create(true)},create:function(f){var g=this;this._super(f);this.pbjId="PBJ_"+this.objId;this.divOut.attr("id",this.pbjId).addClass("pbj").css({width:this.p.width,height:this.p.height,position:"relative"});var e;if(d.isFF){if(!d.isFFgt4){e="-moz-border-radius"}else{e="border-radius"}}else{if(d.isWebkit){e="-webkit-border-radius"}else{if(d.isOpera||d.isIEgt9){e="border-radius"}}}if(e&&this.p.radius>0){this.divOut.css(e,this.p.radius+"px")}if(d.checkTag("progress")&&!d.isOpera){if(this.p.value>=this.p.max){this.divOut.addClass("pbj_max")}else{this.divOut.addClass("pbj_normal")}this.progress=b("<progress class='pbj_progress' value='"+this.p.value+"' max='"+this.p.max+"'></progress>").css({borderRadius:this.p.radius,width:this.p.width,height:this.p.height,borderWidth:this.p.borderP,backgroundColor:this.p.colorParams.bgColor});if(this.p.colorParams.borderOut){this.progress.css("border-color",this.p.colorParams.borderOut)}}else{this.divOut.css("border-width",this.p.borderP);this.progress=b('<div class="pbj_progressDiv"></div>').css({borderRadius:(this.p.radius-2)+"px 0 0 "+(this.p.radius-2)+"px",width:this.countValue(),height:this.p.height});if(this.p.colorParams.progressColor){this.progress.css("background-color",this.p.colorParams.progressColor)}}if(this.p.hasTxt){this.progressTxt=b("<div class='pbj_percent'>"+this.valueMsgTmp.replace(/\{0\}/g,this.p.value)+"</div>").css({display:this.p.hideTxt?"none":"block"});if(this.p.colorParams.progressTxt){this.progressTxt.css("color",this.p.colorParams.progressTxt)}this.divOut.append(this.progressTxt)}this.divOut.append(this.progress);return this},getValue:function(){return this.p.value},setValue:function(j,i){var g=this;this.p.value=j;if(!d.RX.numZ(j)){this.p.value=0}if(this.p.value>this.p.max){this.p.value=this.p.max}if(d.checkTag("progress")&&!d.isOpera){var f=function(){if(g.p.value==g.p.max){g.divOut.swapClassJ("pbj_normal","pbj_max")}else{g.divOut.swapClassJ("pbj_max","pbj_normal")}if(g.p.hasTxt){g.progressTxt.text(g.p.value+"%")}g.fire("progressChanged",{value:g.p.value})};if(d.isChrome){this.progress.css("width",this.p.width)}if(!i){this.progress.attr("value",this.p.value);f()}else{var e={value:this.p.value};this.progress.animate(e,i,function(){f()})}}else{var f=function(){if(!d.isIElt9){if(g.p.value==g.p.max){g.progress.css({borderRadius:(g.p.radius-2)+"px"})}else{g.progress.css({borderRadius:(g.p.radius-2)+"px 0 0 "+(g.p.radius-2)+"px"})}}if(g.p.hasTxt){g.progressTxt.text(g.p.value+"%")}g.fire("progressChanged",{value:g.p.value})};var h=this.countValue();if(!i){this.progress.width(h);f()}else{var e={width:h};this.progress.animate(e,i,function(){f()})}}},start:function(f){var e=this;this.stopP=false;(function(){if(!e.stopP){if(e.p.value>=e.p.max){e.p.value=0}e.setValue(parseInt(e.p.value,10)+e.p.autoRise);setTimeout(arguments.callee,e.p.autoDelay)}})()},stop:function(){this.stopP=true},clear:function(){this.stop();this.setValue(0)},countValue:function(){var e=this.p.value/this.p.max;if(!c.RX.percent(this.p.width)){e=this.p.width*e}else{e=e*100+"%"}return e}});d.PBJ.createProgressBarStr=function(i,f,h,e){var g=h*(i/f);return'<div class="pbj_progressDiv" style="width:'+g+"px;height:"+e+'px;"></div>'};b.fn.extend({ProgressBarJ:function(e){if(this&&this.length>0){return new d.ProgressBarJ(this,c.PBJ_commonConfig?b.extend(true,c.clone(c.PBJ_commonConfig),e):e)}},PBJ:function(e){return b(this).ProgressBarJ(e)}})});