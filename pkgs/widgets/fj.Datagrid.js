FJ.define("widget.Datagrid",["widget.ScrollBar","widget.Menu","widget.Window"],function(){var d,c,a=d=c=this.flareJ,b=this.jQuery;this.DatagridJ=this.DGJ=d.DatagridJ=d.DGJ=d.CJ.extend({init:function(e,f){this._super(e,b.extend(true,{fjType:"DGJ",renderTo:e,renderType:"prepend",renderToMuj:"body",layoutDelay:500,columns:[{text:"ID",dataIndex:"id"}],showOnInit:true,emptyTxt:"没有数据",emptyRowH:30,hasChk:false,hideChk:false,hasChkAll:false,isChkAll:false,hasChkG:false,hasChkGR:false,hasChkT:false,isCheckOne:false,defaultH:20,defaultHH:20,defaultHF:20,defaultW:150,defaultMinW:30,defaultAlign:"center",lockColumn:0,lockColumnR:0,lcMinWidth:80,dynamicLockColumn:false,hasGroup:false,renderGroupRow:null,renderSonRow:null,sonRowName:"sonRows",asyncLoadSonRow:false,collapseSonRow:false,collapseAnimate:false,collapseSpeed:400,isTree:false,isTreeGrid:false,nodeIndex:"nodes",idField:"id",nodePathField:"nodePath",nodeChkField:"nodeChk",asyncLoadTree:false,treeUrl:null,judgeLeaf:null,isRowHighlight:c.isMobile?false:true,treeLocalLazy:true,checkAsyncLoad:null,nodeDeepRetract:17,easing:"easeOutExpo",chkStyle:true,chkCollapse:false,groupRowH:null,useSingleThColor:false,useNewRowColor:false,chkWidth:20,canColumeDD:c.isMobile?false:true,hideColumeDD:[],canSort:true,isCustomSort:false,noSortSp:null,defaultSortCol:null,defaultSortAsc:true,canCopy:true,canHideCol:true,canFullScreen:true,canExportCsv:true,csvDot:"'",canChangeTheme:true,canRefreshPage:true,csvMenuName:"导出excel",csvFileName:"导出表格数据",ddPosType:"offset",isLazyLoad:false,lazyLoadSpeed:5,lazyInfo:'表格数据还未完全显示,您可以向下拖动滚动条继续查看,或在右键菜单中选择"显示全部数据"。',lazyDataLimit:20,lazyScrollBottom:150,isPageCache:false,highLightFade:d.isIElt9?0:1,hasFloatBtn:true,floatBtnImg:null,fbSpace:c.isMobile?false:true,stopHideColumn:[],defaultHideColumn:[],hasSelectColor:true,hasGridFoot:false,isMergeCellF:false,pMergeCellF:{n:2,j:1},isMergeCellV:false,mcShift:7,hasRowContextMenu:c.isMobile?false:true,hideMenuWidth:150,contextMenuItems:[],zIndexMenu:601,zIndexMenuC:602,canSelectRow:false,canSelectRowR:false,isReservedSbjH:false,hideScrollH:c.isMobile?true:false,isAutoSetHeight:true,isAutoSetWidth:true,width:450,height:"auto",borderWidth:0,storeName:null,quickRenderMode:false,sortLoading:false,exportCol:null,noGridBorder:false,noBorder:false,isShowNodeImg:true,hideImgB:false,imgBw:16,imgBmarginR:2,nodeMarginL:10,filterTag:null,isHideHead:false,hasHeadTip:false,headTipConfig:null,autoNo:null,cellPadding:null,cellInnerPadding:null,editSetHeight:false,compatibleMode:false,useObjParam:false,percentWidth:false,hideBlankImg:false,colorParams:{borderOut:null,bgColor:null,highlight:null,select:"#d2e1f6",trColor1:null,trColor2:null,thColor:null,groupRow:null,groupRow2:null,newRow:"#e1e1e1",spRowColor:"#FFCC00",selectColor:null,trColorFoot:null},evts:{dataLoaded:null,afterSetWidth:null,preColumnRender:null,rowContextMenu:null,beforeCopy:null,beforeSortLoading:null,afterSortLoading:null},eType:(function(g){return{afterRender:g,initComplete:g,beforeRemove:g}})("DGJ")},f));this.initFn();return this},initFn:function(){var p=this;this.hasAnimateHl=false;if(c.jQversion){if(c.jQversion[0]<2&&c.jQversion[1]<8){this.hasAnimateHl=jQuery.fx.step.backgroundColor&&this.p.highLightFade}}if(this.p.isTree){this.p.hideChk=true}LMJ.preLoadImg(3);LMJ.preLoadImg(4);this.useMbj=true;this.data=[];this.data.lengthD=0;this.rows=[];this.pageNo=1;this._super();this.isLoading=false;if(this.p.isPageCache){this.pageCache=[];this.datas=[]}if(this.p.isLazyLoad){this.lazyRowNo=0}else{this.p.lazyDataLimit=-1}if(this.p.collapseSonRow){this.shiftG=10;if(d.isIElt8){this.shiftG=12}else{if(d.isIE8||d.isIE9||d.isIE10||d.isWebkit||d.isOpera){this.shiftG=11}}}if(this.p.canFullScreen){this.isFullScreen=false}if(this.p.storeName){try{var r=d.LocalStorage.getItem({key:this.p.storeName+"_hide"});if(r){var j=JSON.parse(r);for(var n=0,h=j.length;n<h;n++){var u=j[n];this.p.columns[u].isHide=true}}else{this.hideColumnD()}var q=d.LocalStorage.getItem({key:this.p.storeName+"_colWidth"});if(q){var m=JSON.parse(q);for(var f in m){this.p.columns[f].width=m[f]}}}catch(s){}}else{this.hideColumnD()}for(var n=0,h=this.p.columns.length;n<h;n++){var g=this.p.columns[n];if(this.p.lockColumn&&n<this.p.lockColumn-1){g.lockCol="l"}else{if(this.p.lockColumnR&&n>=this.p.lockColumnR-1){g.lockCol="r"}}g.colId=n}var k=b("#nbspFixJ");if(!k.length){k=b('<input type="hidden" id="nbspFixJ" value="&nbsp;" />');d.oBody.prepend(k)}this.nbspJ=k.val();if(this.p.isTreeGrid){this.blankImg='<img class="dgj_blank'+(this.p.hideBlankImg?" fj-hidden-pc":"")+'" style="width:'+this.p.imgBw+"px;margin-right:"+this.p.imgBmarginR+'px;" src="'+c.imgPath+'Datagrid/treegrid/s.gif" />';if(this.p.asyncLoadTree){this.p.treeLocalLazy=false}this.p.chkStyle=false}if(this.p.isTree){this.p.isHideHead=true}if(this.p.noGridBorder){this.p.mcShift-=2}if(this.p.isMergeCellV){this.p.canSort=false}for(var n=0,t=this.p.columns,h=t.length;n<h;n++){if(t[n].columnGroup!=null){this.columnGroup={};this.p.canHideCol=false;break}}if(c.isMobile){this.p.canExportCsv=false;this.p.hasRowContextMenu=false}this.create();if(this.p.showOnInit){this.show();p.clearData(true);p.fire("initComplete","DGJ")}if(this.p.hasGridFoot&&this.p.isMergeCellF){this.mergeCellFn(this.p.pMergeCellF.n,this.p.pMergeCellF.j,this.trF)}if(this.p.lockColumn){this.p.collapseAnimate=false}if(c.isFF){setTimeout(function(){p.reLayout()},1000)}},create:function(){var f=this;this._super();this.divOut.attr("id","DGJ_"+this.objId).addClass("dgj").css({width:this.p.width,height:this.p.height});if(c.isMobile){this.divOut.addClass("fj-mobile")}this.headContainer=b('<div class="dgj_headContainer"></div>');if(this.p.isHideHead){this.headContainer.height(0)}if(this.p.borderWidth){this.headContainer.addClass("dgj_headContainerB")}this.bodyContainer=b('<div class="dgj_bodyContainer'+(c.isMobile?" fj-mobile":"")+'"></div>');if(!this.p.isTree){this.bodyContainer.bind("scroll",function(){if((d.isIElt8)&&f.p.lockColumn){f.lcContainer.css("position","static");d.lazyDo(function(){this.lcContainer.css("position","relative");var i=this.sbj.getScrollLeft();if(i>0){this.sbj.setScrollLeft(i+1);this.sbj.setScrollLeft(i-1)}else{this.setDDPosition(true)}},500,"ld_dgjScV",f)}d.lazyDo(function(){this.headContainer.scrollLeft(this.bodyContainer.scrollLeft());if(this.p.isLazyLoad){if(this.lazyRowNo>this.data.length-1){this.divOut.attr("title","");return}this.lazyAddRow();this.joinCacheData()}},f.p.lazyLoadSpeed,"ld_dgjBodyC",f)})}this.tableHead=b('<table class="dgj_tableH1"></table>');if(this.p.borderWidth){this.tableHead.css("margin-left",-1)}this.mainHeadContainer=b('<div class="dgj_mainHeadContainer"></div>');this.mainHeadContainer.append(this.tableHead);this.table=b('<table class="dgj_table1"></table>');if(this.p.isHideHead){this.table.css("marginTop",0)}if(this.p.borderWidth){this.table.css("margin-left",-1)}if(this.p.noBorder){this.table.css("border-width",0)}this.mainContainer=b('<div class="dgj_mainContainer"></div>');if(this.p.percentWidth){this.mainContainer.css("width","100%");this.table.css("width","100%")}this.mainContainer.append(this.table);this.gridContainer=b('<div class="dgj_gridContainer"></div>');this.gridContainer.append(this.headContainer.append(this.mainHeadContainer)).append(this.bodyContainer.append(this.mainContainer));if(this.p.hasGridFoot){this.footContainer=b('<div class="dgj_footContainer"></div>');this.tableFoot=b('<table class="dgj_tableF1"></table>');this.mainFootContainer=b('<div class="dgj_mainFootContainer"></div>');this.mainFootContainer.append(this.tableFoot);this.gridContainer.append(this.footContainer.append(this.mainFootContainer))}this.sBarHContainer=b('<div class="dgj_sBarHContainer"></div>');if(this.p.lockColumn){this.tableHead2=b('<table class="dgj_tableH2"></table>').css("margin-left",-1);this.lcHeadContainer=b('<div class="dgj_lcHeadContainer"></div>');this.lcHeadContainer.append(this.tableHead2);this.lcContainer=b('<div class="dgj_lcContainer"></div>');this.mainHeadContainer.css("width","auto");this.mainContainer.css("width","auto");this.table2=b('<table class="dgj_table2"></table>').css("margin-left",-1);if(this.p.isHideHead){this.table2.css("marginTop",0)}if(this.p.noBorder){this.table2.css("border-width",0)}this.lcContainer.append(this.table2);this.thead2=b("<thead></thead>");this.trH2=b("<tr></tr>");this.thead2.append(this.trH2);if(this.columnGroup){this.trHcg2=b("<tr></tr>");this.thead2.append(this.trHcg2)}this.thds2=[];this.ths2=[];this.tbody2=b("<tbody></tbody>");this.tableHead2.append(this.thead2);this.table2.append(this.tbody2)}if(this.p.lockColumnR){this.tableHead3=b('<table class="dgj_tableH3"></table>');this.rightHeadContainer=b('<div class="dgj_rightHeadContainer"></div>');this.rightHeadContainer.append(this.tableHead3);this.rightContainer=b('<div class="dgj_rightContainer"></div>');this.table3=b('<table class="dgj_table3"></table>');if(this.p.isHideHead){this.table3.css("marginTop",0)}if(this.p.noBorder){this.table3.css("border-width",0)}this.mainContainer.css("width","auto");this.rightContainer.append(this.table3);this.thead3=b("<thead></thead>");this.trH3=b("<tr></tr>");this.thead3.append(this.trH3);if(this.columnGroup){this.trHcg3=b("<tr></tr>");this.thead3.append(this.trHcg3)}this.thds3=[];this.ths3=[];this.tbody3=b("<tbody></tbody>");this.tableHead3.append(this.thead3);this.table3.append(this.tbody3)}this.thead=b("<thead></thead>");this.trH=b("<tr></tr>");this.thead.append(this.trH);if(this.columnGroup){this.trHcg=b("<tr></tr>");this.thead.append(this.trHcg)}this.tableHead.append(this.thead);if(this.p.hasChk){this.chks=[];this.thAll=b('<th class="dgj_cell" chkCell="true" style="text-align:center;'+(!this.p.hideChk?"":"display:none;")+(this.p.borderWidth?"border-top:0;border-bottom:0;":"")+'"></th>').css({height:this.p.defaultHH});this.tdDivAll=b('<div chkCellDiv="true" class="dgj_tdDiv dgj_chkDiv"></div>').css({width:this.p.chkWidth});this.thAll.append(this.tdDivAll);if(this.p.hasChkAll&&!this.p.isCheckOne){this.chkAll=b('<input title="全选" id="dgj_chkall_'+this.p.objId+'" type="checkbox" hidefocus />');if(this.p.chkStyle){this.sbxjAll=this.chkAll.SBXJ({initClass:"dgj_chkC",type:this.p.chkCollapse?"collapse":null,isInitHide:false,canQuery:false});this.tdDivAll.append(this.sbxjAll.divOut)}else{this.tdDivAll.append(this.chkAll)}this.chkAll.click(function(i){i.stopPropagation();f.fnChkAll(this);f.fire("checkedAll",{checked:this.checked})})}this.trH.append(this.thAll)}var t=[];this.thds=[];this.thds1=[];this.ths1=[];for(var N=0,w=this.p.columns,J=w.length,q=0,p=0,o=0,L=0;N<J;N++){var M,P,S,m,H=this.getColType(N),R=w[N],x=!this.columnGroup||!R.columnGroup;switch(H){case 0:case 1:if(x){M=this.trH}else{M=this.trHcg;P=this.trH}S=this.thds1;m=this.ths1;L=q;q++;break;case 2:if(x){M=this.trH2}else{M=this.trHcg2;P=this.trH2}S=this.thds2;m=this.ths2;L=p;p++;break;case 3:if(x){M=this.trH3}else{M=this.trHcg3;P=this.trH3}S=this.thds3;m=this.ths3;L=o;o++;break}M.append((function(W,k,j){var v=b('<div class="dgj_tdDiv dgj_thDiv"></div>');if(!f.p.isHideHead){v.css({width:f.p.defaultW})}if(W.headTip){v.attr("headTip",W.headTip)}if(!W.headerFn){v.append('<span class="dgj_thSp">'+W.text+"</span>")}else{aRf=[v,W.headerFn,W.text,W,k,M];t.push(aRf)}var V=b('<th class="dgj_cell" '+(f.p.borderWidth?'style="border-top:0;border-bottom:0;"':"")+"></th>").css({height:f.p.defaultHH});V.attr("colId",k);if(W.editable){V[0].style.padding="0px";v[0].style.padding="0px 5px 0px 1px"}if(f.p.canSort&&!W.noSort){f.setCellSort(k,W,V,v,true)}if(W.width){if(!f.p.isHideHead){v.css({width:W.width})}}else{f.columnP=k}V.append(v);if(f.columnGroup){if(!W.columnGroup){V.attr("rowspan",2)}else{var U=f.columnGroup[W.columnGroup];if(!U){U=b('<th class="dgj_cell" colspan="1" dgjCs="1"><div class="dgj_tdDiv dgj_thDiv">'+W.columnGroup+"</div></th>");f.columnGroup[W.columnGroup]=U;P.append(U);if(f.p.lockColumn){switch(j){case 0:case 1:f.hasCg1=true;break;case 2:f.hasCg2=true;break;case 3:f.hasCg3=true;break}}}else{var l=parseInt(U.attr("dgjCs"),10);U.attr("colspan",l+1)}}}f.thds.push(v[0]);S.push(v[0]);m.push(V[0]);return V})(R,N,H));if(R.mergeCellH){this.mergeCellH(R.mergeCellH,L,M);for(var K=N;K>N-R.mergeCellH;K--){this.p.hideColumeDD[this.p.hideColumeDD.length]=K}}}for(var K=0,J=t.length;K<J;K++){var E=t[K],G=E[1].call(f,E[2],E[3],E[4],E[5]);E[0].append('<span class="dgj_thSp">'+G+"</span>")}this.thds=b(this.thds);this.thds1=b(this.thds1);this.ths1=b(this.ths1);if(this.p.lockColumn){this.thds2=b(this.thds2);this.ths2=b(this.ths2)}if(this.p.lockColumnR){this.thds3=b(this.thds3);this.ths3=b(this.ths3)}if(this.p.hasGridFoot){this.tfoot=b("<tfoot></tfoot>");this.trF=b("<tr></tr>");if(this.p.colorParams.trColorFoot){this.trF.css("background-color",this.p.colorParams.trColorFoot)}this.tfoot.append(this.trF);this.tableFoot.append(this.tfoot);if(this.p.hasChk){this.tdAllF=b('<td chkCell="true" style="text-align:center;"></td>').css({height:this.p.defaultHF});this.tdDivAllF=b('<div class="dgj_tdDiv"></div>').css({width:this.p.chkWidth});this.tdAllF.append(this.tdDivAllF);this.trF.append(this.tdAllF)}for(var N=0,w=this.p.columns,J=w.length;N<J;N++){var Q;if(!this.p.lockColumn){Q=this.trF}else{}Q.append((function(v,j){var k=b('<div class="dgj_tdDiv"></div>').css({width:f.p.defaultW});if(v.textF){k.append(v.textF)}if(v.align){k.css("text-align",v.align)}else{k.css("text-align",f.p.defaultAlign)}var l=b("<td></td>").css({height:f.p.defaultHF});l.attr("colId",j);k.css({width:v.width});l.append(k);return l})(w[N],N))}}if(this.p.hasFloatBtn){this.floatBtn=b('<input type="button" title="点击可自定义设置" onclick="this.focus()" hidefocus id="dgj_floatBtn_'+this.objId+'" class="dgj_floatBtn" />');if(this.p.floatBtnImg){this.floatBtn.css("background-image","url("+this.p.floatBtnImg+")")}if(this.p.isTree){this.floatBtn.css({top:0,right:20})}this.divOut.parent().append(this.floatBtn)}var s=[];var C=[];var z=[];for(var D=0,w=this.p.columns,J=w.length;D<J;D++){if(this.p.stopHideColumn.length==0||b.inArray(D,this.p.stopHideColumn)==-1){(function(j){var i=w[j].colId;s.push({id:"hideCol"+j,text:w[j].text,hasChk:true,click:function(k){f.hideColumnMenu(j,k.checked,k.chk)}})})(D)}}var T={id:"dgjHcMuj_"+this.objId,text:"隐藏列",maxHeight:300,width:this.p.hideMenuWidth,shiftLeft:111-this.p.hideMenuWidth,menus:s,evts:{afterBodyLoad2:function(){for(var k=0,j=this.chks.length;k<j;k++){this.chks[k].setChecked(f.p.columns[k].isHide?false:true,null,true)}}}};var B=[];if(!this.p.isTree&&this.p.canHideCol){B.push(T)}var u,I;if(this.p.dynamicLockColumn){u=[{id:"dgj_muj_lcL_"+this.objId,text:"左侧",width:this.p.hideMenuWidth,shiftLeft:96-this.p.hideMenuWidth,menus:C},{id:"dgj_muj_lcR_"+this.objId,text:"右侧",width:this.p.hideMenuWidth,shiftLeft:96-this.p.hideMenuWidth,menus:z}];B.push({text:"冻结列",maxHeight:300,menus:u,evts:{afterItemRender:function(j,i){if(f.p.dynamicLockColumn){I(i)}}}});I=function(i){if(i.id=="dgj_muj_lcL_"+f.objId&&!f.mujLcL){f.mujLcL=d.get("dgj_muj_lcL_"+f.objId)}if(i.id=="dgj_cmj_lcL_"+f.objId&&!f.cmjLcL){f.cmjLcL=d.get("dgj_cmj_lcL_"+f.objId)}if(i.id=="dgj_muj_lcR_"+f.objId&&!f.mujLcR){f.mujLcR=d.get("dgj_muj_lcR_"+f.objId)}if(i.id=="dgj_cmj_lcR_"+f.objId&&!f.cmjLcR){f.cmjLcR=d.get("dgj_cmj_lcR_"+f.objId)}}}var r,A,n,y,e;if(this.p.storeName){r={text:"清除表格列状态",icon:"<img src='"+d.imgPath+"Menu/deleteUser.gif' />",click:function(){d.LocalStorage.removeItem({key:f.p.storeName+"_hide"});d.LocalStorage.removeItem({key:f.p.storeName+"_colWidth"});this.setVisible(false)}};B.push(r)}if(this.p.canFullScreen){A={id:"dgjFs_"+this.objId,text:"全屏显示",icon:"<img src='"+d.imgPath+"Menu/imgBrowser.gif' />",click:function(i){this.setVisible(false);f.fnFullScreen()}};B.push(A)}if(this.p.canChangeTheme){e={id:"dgjCt_"+this.objId,text:"切换主题",shiftLeft:11,menus:[{text:"蓝色",icon:"<img src='"+d.imgPath+"Menu/theme_blue.gif' />",click:function(i){c.theme.change("blue")}},{text:"灰色",icon:"<img src='"+d.imgPath+"Menu/theme_gray.gif' />",click:function(i){c.theme.change("gray")}}]};B.push(e)}if(this.p.isLazyLoad){n={text:"显示全部数据",icon:"<img src='"+d.imgPath+"Menu/load.gif' />",click:function(){this.setVisible(false);if(f.useMbj){MBJ.loading("提示","正在加载中,请稍候...",function(){var i=this;setTimeout(function(){f.autoLoadlazyRow(true);i.close()},100)})}else{f.autoLoadlazyRow(true)}}};B.push(n)}if(this.p.canExportCsv){y={text:this.p.csvMenuName,id:"dgjExportCsvMuj_"+this.objId,icon:"<img src='"+d.imgPath+"FileUpload/filetype/xls.gif' />",click:function(){setTimeout(function(){if(!c.isLocal){if(parseFloat(d.getFlashVer().split(".")[0])<10){f.alert("您的浏览器flash版本过低或没有安装flash插件,请先升级或安装flash插件(10.0以上版本)后再执行导出。")}}else{f.alert("本地模式不支持导出操作")}},50)}};window["getCsvData_"+this.objId]=function(){return f.p.csvFileName+c.Date.toFormatString(new Date(),"yyyymmddhhMMss")+"<split/>"+f.getGridText(true)};window["callBackCsvData_"+this.objId]=function(){var i;if(!f.p.isTree&&f.p.hasFloatBtn){i=f.mujFbtn}else{i=f.rowCmj}i.setVisible(false)};window["setExportBtnOver_"+this.objId]=function(){f.itemCsvMuj.trigger("mouseenter")};window["setExportBtnOut_"+this.objId]=function(){f.itemCsvMuj.trigger("mouseleave")};window["setFxCsvPosition_"+this.objId]=function(i){if(!c.isIE){var j;if(!f.p.isTree&&f.p.hasFloatBtn){j=f.mujFbtn}else{j=f.rowCmj}if(i==1){j.p.canClose=false}else{if(i==2){j.p.canClose=true}}}};window["exportCsvError_"+this.objId]=function(){f.alert("您的系统中有已打开的同名excel文件,请先关闭该excel文件或修改文件名后再执行导出。")};B.push(y);var F=function(j){if(f.itemCsvMuj&&!j.isLoadEhj&&parseFloat(d.getFlashVer().split(".")[0])>=10&&!c.isLocal){j.isLoadEhj=true;var k="dgjCsvDivMuj_"+f.objId,i=j;j.bodyIn.append(b("<div id='"+k+"'></div>"));setTimeout(function(){d.FX.create(k,d.rootPath+"resources/swf/ExportCsvHelperJ.swf",k,i.p.width,24,{getCsvData:"getCsvData_"+f.objId,callBackCsvData:"callBackCsvData_"+f.objId,setExportBtnOver:"setExportBtnOver_"+f.objId,setExportBtnOut:"setExportBtnOut_"+f.objId,setFxCsvPosition:"setFxCsvPosition_"+f.objId,exportCsvError:"exportCsvError_"+f.objId},null,"10.0.0");b("#"+k).css({position:"absolute",top:f.itemCsvMuj.position().top})},1)}}}if(this.p.hasFloatBtn){this.mujFbtn=b(this.floatBtn).MUJ({renderTo:this.p.renderToMuj,showRendorBody:this.p.renderToMuj!=null?true:false,hoverDirect:"left",cMenuDirect:"left",autoDirect:false,shiftLeft:-105,shiftTop:19,width:115,menus:B,zIndex:this.p.zIndexMenu,tranOrigin:"85% 0%",tranScaleShow:"scale(1, 0.1)",tranScaleClose:"scale(1, 0.8)",evts:{afterItemRender:function(j,i){if(i.id=="dgjFs_"+f.objId){f.btnFs=i.item}if(i.id=="dgjHcMuj_"+f.objId){f.mujHc=i.menu}if(f.p.canExportCsv&&i.id=="dgjExportCsvMuj_"+f.objId){f.itemCsvMuj=i.item;this.bodyIn.css("position","relative")}},afterBodyLoad2:function(){if(f.p.canExportCsv){F(this)}if(f.p.hasRowContextMenu){f.rowCmj.setVisible(false)}}}})}if(this.p.hasRowContextMenu){T.id="dgjHcCmj_"+this.objId;if(this.p.canFullScreen){A.id="dgjFsCmj_"+this.objId}if(this.p.canChangeTheme){e.id="dgjCtCmj_"+this.objId}if(this.p.dynamicLockColumn){u[0].id="dgj_cmj_lcL_"+this.objId;u[1].id="dgj_cmj_lcR_"+this.objId}if(this.p.canCopy){window["getClipboardData_"+this.objId]=function(){var i=f.fire("beforeCopy");if(i==null){i=f.getGridText()}return i};window["callBackClipboardData_"+this.objId]=function(){f.rowCmj.setVisible(false)};window["setCopyBtnOver_"+this.objId]=function(){f.itemCopyCmj.trigger("mouseenter")};window["setCopyBtnOut_"+this.objId]=function(){f.itemCopyCmj.trigger("mouseleave")};if(d.isIE||d.isFF||parseFloat(d.getFlashVer().split(".")[0])>=9){B.unshift({id:"dgjCopyCmj_"+this.objId,text:"复制",icon:"<img src='"+d.imgPath+"Menu/copy.gif' />",title:d.isIE?'友情提示:如果您点击复制时浏览器提示是否允许访问剪贴板,您可以请依次点击进入"工具">"Internet选项">"安全">"自定义级别"将"允许对剪贴板进行编程访问"项设置为"启用"。':null,click:function(j){var i=window["getClipboardData_"+f.objId]();this.setVisible(false);setTimeout(function(){if(d.isIE){window.clipboardData.setData("text",i)}else{if(d.isFF){try{netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect")}catch(V){f.alert("复制操作被浏览器拒绝！\n请在浏览器地址栏输入'about:config'并回车\n然后将'signed.applets.codebase_principal_support'设置为'true'")}var v=Components.classes["@mozilla.org/widget/clipboard;1"].createInstance(Components.interfaces.nsIClipboard);if(!v){return}var l=Components.classes["@mozilla.org/widget/transferable;1"].createInstance(Components.interfaces.nsITransferable);if(!l){return}l.addDataFlavor("text/unicode");var W=new Object();var k=new Object();var W=Components.classes["@mozilla.org/supports-string;1"].createInstance(Components.interfaces.nsISupportsString);var X=i;W.data=X;l.setTransferData("text/unicode",W,X.length*2);var U=Components.interfaces.nsIClipboard;v.setData(l,null,U.kGlobalClipboard)}else{f.alert("对不起，您的浏览器不支持复制操作")}}},50)}})}}if(this.p.isTreeGrid&&this.p.asyncLoadTree){B.push({text:"刷新子节点",icon:"<img src='"+d.imgPath+"Pagination/refresh.gif' />",click:function(i){this.setVisible(false);f.refreshChildNode(f.currentNode)}})}if(this.p.canRefreshPage){B.push({text:"刷新页面",icon:"<img src='"+d.imgPath+"Pagination/refresh.gif' />",click:function(){this.setVisible(false);setTimeout(function(){location.reload(true)},100)}})}b.merge(this.p.contextMenuItems,B);if(!this.p.isTree&&this.p.canExportCsv&&this.p.hasFloatBtn){for(var N=0,J=this.p.contextMenuItems.length;N<J;N++){if(this.p.contextMenuItems[N].id==("dgjExportCsvMuj_"+this.objId)){c.arr.removeAt(this.p.contextMenuItems,N);break}}}this.rowCmj=b(this.gridContainer).CMJ({renderTo:this.p.renderToMuj,showRendorBody:this.p.renderToMuj!=null?true:false,zIndex:this.p.zIndexMenuC,menus:this.p.contextMenuItems,width:115,showOnSelectText:false,tranOrigin:"50% 0%",tranScaleShow:"scale(1, 0.1)",tranScaleClose:"scale(1, 0.8)",evts:{afterShow:function(){f.fire("rowContextMenu")},afterBodyLoad2:function(){if(f.p.canCopy&&f.itemCopyCmj&&!this.isLoadChj&&parseFloat(d.getFlashVer().split(".")[0])>=9&&!c.isLocal){this.isLoadChj=true;var i="dgjCopyDivCmj_"+f.objId,j=this;this.bodyIn.append(b("<div id='"+i+"'></div>"));setTimeout(function(){d.FX.create(i,d.rootPath+"resources/swf/CilpboardHelperJ.swf",i,j.p.width,24,{getClipboardData:"getClipboardData_"+f.objId,callBackClipboardData:"callBackClipboardData_"+f.objId,setCopyBtnOver:"setCopyBtnOver_"+f.objId,setCopyBtnOut:"setCopyBtnOut_"+f.objId},null,"9.0.0");b("#"+i).css({position:"absolute",top:f.itemCopyCmj.position().top})},1)}if((f.p.isTree||!f.p.hasFloatBtn)&&f.p.canExportCsv){F(this)}if(f.mujFbtn){f.mujFbtn.setVisible(false)}},afterItemRender:function(j,i){if(i.id=="dgjFsCmj_"+f.objId){f.btnFsCmj=i.item}if(i.id=="dgjCopyCmj_"+f.objId){f.itemCopyCmj=i.item;this.bodyIn.css("position","relative")}if((f.p.isTree||!f.p.hasFloatBtn)&&f.p.canExportCsv&&i.id=="dgjExportCsvMuj_"+f.objId){f.itemCsvMuj=i.item;this.bodyIn.css("position","relative")}}}})}this.tbody=b("<tbody></tbody>");this.table.append(this.tbody);this.divOut.append(this.gridContainer).append(this.sBarHContainer);this.sbj=b(this.sBarHContainer).SBJ({width:0,widthC:0,style:d.isIE7?"float:left;":null,evts:{scroll:function(j,i){if(!f.p.lockColumn){f.headContainer[0].scrollLeft=i.s.scrollLeft;f.bodyContainer[0].scrollLeft=i.s.scrollLeft;if(f.p.hasGridFoot){f.footContainer[0].scrollLeft=i.s.scrollLeft}d.lazyDo(function(){if(this.p.canColumeDD){this.setDDPosition()}},100,"ld_dgjScroll",f)}else{f.lcHeadContainer[0].scrollLeft=i.s.scrollLeft;f.lcContainer[0].scrollLeft=i.s.scrollLeft;d.lazyDo(function(){if(this.p.canColumeDD){this.setDDPosition(true)}},100,"ld_dgjScroll",f)}}}});if(this.p.lockColumn){this.headContainer.append(this.lcHeadContainer);this.bodyContainer.append(this.lcContainer);this.gridContainer.bind("scroll",function(){if(f.p.lockColumn){d.lazyDo(function(){this.setSbjPostionLc()},f.p.lazyLoadSpeed,"ld_dgjGridC",f)}})}if(this.p.lockColumnR){this.headContainer.append(this.rightHeadContainer);this.bodyContainer.append(this.rightContainer)}if(this.p.useSingleThColor&&this.p.colorParams.thColor){this.headContainer.find("th").css({backgroundImage:"none",backgroundColor:this.p.colorParams.thColor})}if(this.p.canColumeDD){this.setColumeDD()}b(window).bind("resize",function(){if(!f.divOut.is(":hidden")){d.lazyDo(function(){this.reLayout(this.p.asyncLoadTree?true:false,this.p.isTree)},f.p.layoutDelay,"ld_dgjMH",f)}});this.fire("afterRender","DGJ");if(this.p.hasHeadTip&&!this.p.isTree){var O=this.headContainer.find("div[headTip].dgj_thDiv");if(O.length>0){var g=this.p.headTipConfig,h={showRendorBody:true,showHead:false,speed:1,showSpeed:10,hoverSpeed:100,loadSpeed:1,showLoading:false,zIndex:1000,isBodyEmpty:true,hoverOnTip:c.isMobile?false:true,radius:d.isIElt9?0:5,urlType:"html",posType:"offset",hoverDirect:"bottom",shiftLeft:0,shiftTop:17,width:180,height:50,opacity:0.8,isAutoSetHeight:false,radiusB:4,hasShadow:true,loadHTML:function(){return"<div class='dgj_headTip'>"+this.currentObj.attr("headTip")+"</div>"}};if(g&&g.renderTo){h.renderTo=g.renderTo;delete g.renderTo}else{h.renderTo=this.divOut}this.ttjHeadTip=O.TTJ(b.extend(true,h,g))}}return this},loadData:function(x,z,y,u,e){var w=this;this.data=x;if(this.data&&this.data.lengthD==null){this.data.lengthD=this.data.length}this.judgeLazyDataLimit();if(this.p.isLazyLoad){this.divOut.attr("title","")}if(this.p.hasChk&&this.p.hasChkAll&&this.chkAll){if(this.p.chkStyle){this.sbxjAll.setChecked(false,null,true)}else{this.chkAll[0].checked=false}}if(x&&x.length>0){if(this.p.defaultSortCol){c.Sort.execute(x,this.p.defaultSortCol,this.p.defaultSortAsc,this.p.noSortSp)}if(!this.p.isPageCache){this.chks=[];this.rows=[];if(this.p.isLazyLoad){this.lazyRowNo=0}this.tbody.empty();if(this.p.lockColumn){this.tbody2.empty()}if(this.p.lockColumnR){this.tbody3.empty()}var p={thds:this.thds};if(!this.p.quickRenderMode){for(var t=0,r=x.length;t<r;t++){var o=this.addRow(x[t],t,null,true,null,null,null,null,p);if(this.p.isLazyLoad){this.setMainHeight();this.lazyRowNo=t+1;for(var s=0,h=this.p.columns,q=h.length;s<q;s++){if(h[s].isHide){this.hideColumnR(o,s,false)}}if(t>=this.p.lazyDataLimit-1&&(this.bodyContainer[0].scrollHeight>this.bodyContainer.height()+10)&&t<x.length-1){this.addLoadingRow();this.divOut.attr("title",this.p.lazyInfo);break}}}}else{this.renderTable(x,null,true)}}else{this.pageNo=z;this.pageCacheTotal=y;if(this.p.isLazyLoad){this.bodyContainer.scrollTop(0);this.lazyRowNo=0}var k=this.getPageCache(z);if(k){var v=k[2];this.chks=k[3];this.tbody.hide();this.tbody=v.show();if(this.p.lockColumn){var g=k[4];this.tbody2.hide();this.tbody2=g.show()}if(this.p.lockColumnR){var f=k[5];this.tbody3.hide();this.tbody3=f.show()}if(this.p.isLazyLoad){this.lazyRowNo=k[6];this.addLoadingRow();if(this.lazyRowNo<=this.data.length-1){this.divOut.attr("title",this.p.lazyInfo)}this.autoLoadlazyRow();this.setMainHeight()}}else{this.chks=[];this.rows=[];if(this.tbody){if(this.pageCache.length<=0){this.tbody.remove();if(this.p.lockColumn){this.tbody2.remove()}if(this.p.lockColumnR){this.tbody3.remove()}}else{this.tbody.hide();if(this.p.lockColumn){this.tbody2.hide()}if(this.p.lockColumnR){this.tbody3.hide()}}}this.tbody=b("<tbody></tbody>");this.table.append(this.tbody);if(this.p.lockColumn){this.tbody2=b("<tbody></tbody>");this.table2.append(this.tbody2)}if(this.p.lockColumnR){this.tbody3=b("<tbody></tbody>");this.table3.append(this.tbody3)}var n=this.addPageCache(z,u,e);var p={thds:this.thds};for(var t=0,r=x.length;t<r;t++){var o=this.addRow(x[t],t,null,true,null,null,z,null,p);if(this.p.isLazyLoad){this.setMainHeight();this.lazyRowNo=t+1;n[6]=this.lazyRowNo;for(var s=0,h=this.p.columns,q=h.length;s<q;s++){if(h[s].isHide){this.hideColumnR(o,s,false)}}if(t>=this.p.lazyDataLimit-1&&(this.bodyContainer[0].scrollHeight>this.bodyContainer.height()+10)&&t<x.length-1){this.addLoadingRow();this.divOut.attr("title",this.p.lazyInfo);break}}}this.joinCacheData()}}if(this.p.hasGridFoot&&u){this.loadDataF(u)}this.setTableWidth();this.p.canSort=true;this.mergeCellV();if(!this.p.isLazyLoad){this.setMainHeight();for(var t=0,h=this.p.columns,r=h.length;t<r;t++){if(h[t].isHide){this.hideColumn(t,false,true)}}}this.fire("dataLoaded",{data:x})}else{this.clearData()}this.hideSortImg();this.sbj.setScrollLeft(0);return this},loadDataG:function(z,B,A,w,e){var y=this;this.data=z;if(this.data&&this.data.lengthD==null){this.data.lengthD=this.data.length}this.judgeLazyDataLimit();if(this.p.isLazyLoad){this.divOut.attr("title","")}if(this.p.hasChkG&&this.p.hasChkAll&&this.chkAll){if(this.p.chkStyle){this.sbxjAll.setChecked(false,null,true)}else{this.chkAll[0].checked=false}}if(z&&z.length>0){if(!this.p.isPageCache){this.chks=[];this.rows=[];if(this.p.isChkAll){this.setDefaultChkAll()}if(this.p.isLazyLoad){this.lazyRowNo=0}this.tbody.empty();var p={thds:this.thds};for(var v=0,s=z.length;v<s;v++){var f=[];this.addRowGS(z[v],v,null,null,null,null,f,p);if(this.p.isLazyLoad){this.setMainHeight();this.lazyRowNo=v+1;if(f.length>0){for(var u=0,g=this.p.columns,r=g.length;u<r;u++){if(g[u].isHide){for(var t=0,q=f.length;t<q;t++){this.hideColumnR(f[t],u,false)}}}}if(v>=this.p.lazyDataLimit-1&&(this.bodyContainer[0].scrollHeight>this.bodyContainer.height()+10)&&v<z.length-1){this.addLoadingRow();this.divOut.attr("title",this.p.lazyInfo);break}}}}else{this.pageNo=B;this.pageCacheTotal=A;if(this.p.isLazyLoad){this.bodyContainer.scrollTop(0);this.lazyRowNo=0}var h=this.getPageCache(B);if(h){var x=h[2];this.chks=h[3];this.tbody.hide();this.tbody=x.show();this.rows=h[7];if(this.p.isLazyLoad){this.lazyRowNo=h[6];this.addLoadingRow();if(this.lazyRowNo<=this.data.length-1){this.divOut.attr("title",this.p.lazyInfo)}this.autoLoadlazyRow();this.setMainHeight()}}else{this.chks=[];this.rows=[];if(this.p.isChkAll){this.setDefaultChkAll()}if(this.tbody){if(this.pageCache.length<=0){this.tbody.remove()}else{this.tbody.hide()}}this.tbody=b("<tbody></tbody>");this.table.append(this.tbody);var o=this.addPageCache(B,w,e);var p={thds:this.thds};for(var v=0,s=z.length;v<s;v++){var f=[];this.addRowGS(z[v],v,B,null,null,null,f,p);if(this.p.isLazyLoad){this.setMainHeight();this.lazyRowNo=v+1;o[6]=this.lazyRowNo;if(f.length>0){for(var u=0,g=this.p.columns,r=g.length;u<r;u++){if(g[u].isHide){for(var t=0,q=f.length;t<q;t++){this.hideColumnR(f[t],u,false)}}}}if(v>=this.p.lazyDataLimit-1&&(this.bodyContainer[0].scrollHeight>this.bodyContainer.height()+10)&&v<z.length-1){this.addLoadingRow();this.divOut.attr("title",this.p.lazyInfo);break}}}this.joinCacheData()}}if(this.p.hasGridFoot&&w){this.loadDataF(w)}this.setTableWidth();this.p.canSort=true;if(!this.p.isLazyLoad){this.setMainHeight();for(var v=0,g=this.p.columns,s=g.length;v<s;v++){if(g[v].isHide){this.hideColumn(v,false,true)}}}this.fire("dataLoaded",{data:z})}else{this.clearData()}this.hideSortImg();this.sbj.setScrollLeft(0);return this},loadDataF:function(j){this.dataF=j;var e=this.trF.find("div.dgj_tdDiv");if(this.p.hasChk){e=e.not("div:first")}for(var g=0,k=this.p.columns,f=k.length;g<f;g++){var h=e.eq(g);if(!k[g].renderFnFoot){h.html(j[k[g].dataIndex])}else{h.html(k[g].renderFnFoot.call(this,j[k[g].dataIndex],j,g,this.trF,h))}}},updateHeadText:function(j,e){var h=this.headContainer.find("span.dgj_thSp");for(var g=0,f=j.length;g<f;g++){h.eq(j[g]).html(e[g])}},loadDataT:function(j){var h=this;this.data=j;if(this.data&&this.data.lengthD==null){this.data.lengthD=this.data.length}if(j&&j.length>0){this.chks=[];this.rows=[];this.tbody.empty();if(this.p.lockColumn){this.tbody2.empty()}if(this.p.lockColumnR){this.tbody3.empty()}for(var g=0,e=j.length;g<e;g++){var m={thds:this.thds};var f=j[g][this.p.idField];if(f==null){j[g][this.p.idField]="dgjTg_"+new Date().getTime()+Math.random()}m.deep=0;m.path=g+".";m.expand=true;this.addRow(j[g],0,null,true,null,null,null,null,m)}this.setTableWidth();this.setMainHeight();if(!this.p.isTree){for(var g=0,k=this.p.columns,e=k.length;g<e;g++){if(k[g].isHide){this.hideColumn(g,false,true)}}}this.fire("dataLoaded",{data:j})}else{this.clearData()}this.hideSortImg();this.sbj.setScrollLeft(0);return this},loadDataTAsync:function(i,h,g,e){var f=this;this.fire("beforeTreeLoad",{node:h?h.node:null});this.fire("treeLoad",{node:h?h.node:null,isInit:i,p:h,fn:g});if(e){this.loadTreeNodes(e,i,h,g)}return this},loadTreeNodes:function(n,r,f,v){if(this.p.checkAsyncLoad){this.p.checkAsyncLoad.call(this,n)}if(n&&n.length>0){if(r){this.data=n;if(this.data&&this.data.lengthD==null){this.data.lengthD=this.data.length}this.chks=[];this.rows=[];this.tbody.empty();if(this.p.lockColumn){this.tbody2.empty()}if(this.p.lockColumnR){this.tbody3.empty()}}else{if(this.p.asyncLoadTree){if(n&&n.lengthD==null){n.lengthD=n.length}f.node[this.p.nodeIndex]=n}}var w=null,t=[],e=f&&this.p.collapseAnimate;for(var o=0,h=n.length;o<h;o++){var y={thds:this.thds};var s=n[o][this.p.idField];if(s==null){n[o][this.p.idField]="dgjTg_"+new Date().getTime()+Math.random()}y.expand=true;if(!f){y.deep=0;y.path=o+"."}else{y.parentId=f.pId;y.deep=f.deep+1;y.path=f.path+o+".";n[o].parentNode=f.node;if(!w){w=f.trs}}if(this.p.judgeLeaf){if(this.p.judgeLeaf.call(this,n[o])){n[o].isLeaf=true}}w=this.addRow(n[o],0,w,true,null,null,null,null,y);if(f&&this.p.collapseAnimate){w.hide();t.push(w[0])}if(!this.p.isTree&&!r&&this.p.lockColumn){this.syncRowHeightR(null,w[0],w[1],w[2])}if(!this.p.isTree&&!r){for(var k=0,u=this.p.columns,g=u.length;k<g;k++){if(u[k].isHide){this.hideColumnR(w,k,false)}}}}var q=this,x=function(){for(var m=0,j=n.length;m<j;m++){var p=n[m];if(p.isExpand){q.refreshChildNode(p,true)}}};if(e){this.collapseAnimWrap(true,f.trs[0],b(t),function(){x()})}else{x()}if(v){v.call(this,true)}d.lazyDo(function(){if(r){this.setTableWidth()}if(!e){this.setMainHeight()}},200,"ld_dgjTg1",this);if(!this.p.isTree&&r){for(var o=0,u=this.p.columns,h=u.length;o<h;o++){if(u[o].isHide){this.hideColumn(o,false,true)}}}this.fire("afterTreeLoad",{data:n})}else{if(r){this.clearData()}if(v){v.call(this,false)}}if(r){this.sbj.setScrollLeft(0)}},cascade:function(k,h,j){var m,f=k[this.p.nodeIndex];if(!j){m=h.call(this,k)}if(m!==false&&f){for(var g=0,e=f.length;g<e;g++){this.cascade(f[g],h)}}},bubble:function(g,e,f){var h;if(!f){h=e.call(this,g)}if(h!==false&&g.parentNode){this.bubble(g.parentNode,e)}},seekNode:function(j){var g=this,h,k=this.data;if(k.length<=0){return}for(var f=0,e=k.length;f<e;f++){this.cascade(k[f],function(i){if(i[g.p.nodePathField]==j){h=i;return false}})}return h},getCheckedNodes:function(h){var j=this,f=[];for(var g=0,e=this.data.length;g<e;g++){var k=this.data[g];this.cascade(k,function(l){if(l.isCheck){var i=1;if(h&&!l.isLeaf){if(j.p.judgeLeaf&&j.p.judgeLeaf.call(j,k)){k.isLeaf=true}else{i=0}}if(i){f.push(l)}}})}return f},getCheckedNodeIds:function(m,h){var f=this.getCheckedNodes(h),k=!m?this.p.idField:m,j=STJ.init();for(var g=0,e=f.length;g<e;g++){j.add(f[g][k])}return j.join(",")},deleteChildNode:function(e){if(typeof e=="string"){e=this.seekNode(e)}if(!e){return}this.bodyContainer.find("tr[nodeno^="+e.nodeNo+"][nodeno!="+e.nodeNo+"]").remove();e[this.p.nodeIndex]=null},refreshChildNode:function(f,g){if(typeof f=="string"){f=this.seekNode(f)}if(!f){return}if(!g){this.deleteChildNode(f)}var e=f.nodeIcon;f.nodeImg.swapClassJ("dgj_folderOpen dgj_loadingT","dgj_folderClose");f.isLeaf=false;f.complete=false;e.setChecked(true)},judgeLazyDataLimit:function(){if(this.p.lazyDataLimit>-1){if(this.p.isPageCache){if(this.pageCache.length>0){return}}if(this.data.length<this.p.lazyDataLimit){this.p.isLazyLoad=false}else{this.p.isLazyLoad=true}}},addLoadingRow:function(){if(this.lazyRowNo>=this.data.length){return}var i=0;if(!this.p.lockColumn){i=this.p.columns.length}else{i=this.p.lockColumn-1}if(this.p.hasChk){i+=1}var e=35,f=5;if(this.p.hasGroup){e=50;f=4}if(!this.loadingRow){this.loadingRow=b('<tr loading="true"></tr>').append(b('<td colspan="'+i+'" style="text-align:center;height:'+e+'px;"></td>').append(LMJ.getLoadImg(f)))}else{this.loadingRow.show().find("td").attr("colspan",i)}this.tbody.append(this.loadingRow);if(this.table.find("td:visible").length<=1){this.loadingRow.hide()}if(this.p.lockColumn){var h=this.p.columns.length-this.p.lockColumn+1;if(!this.loadingRow2){this.loadingRow2=b('<tr loading="true"></tr>').append(b('<td colspan="'+h+'" style="text-align:center;height:'+e+'px;"></td>').append(LMJ.getLoadImg(f)))}else{this.loadingRow2.show().find("td").attr("colspan",h)}this.tbody2.append(this.loadingRow2);if(this.table2.find("td:visible").length<=1){this.loadingRow2.hide()}}if(this.p.lockColumnR){var g=this.p.columns.length-this.p.lockColumnR+1;if(!this.loadingRow3){this.loadingRow3=b('<tr loading="true"></tr>').append(b('<td colspan="'+(this.p.columns.length-this.p.lockColumnR+1)+'" style="text-align:center;height:'+e+'px;"></td>').append(LMJ.getLoadImg(f)))}else{this.loadingRow3.show().find("td").attr("colspan",g)}this.tbody3.append(this.loadingRow3);if(this.table3.find("td:visible").length<=1){this.loadingRow3.hide()}}},lazyAddRow:function(k){if(this.lazyRowNo>=this.data.length){this.divOut.attr("title","");return false}if(this.bodyContainer[0].scrollTop+this.bodyContainer[0].clientHeight>this.bodyContainer[0].scrollHeight-(!this.p.hasGroup?this.p.lazyScrollBottom+40:this.p.lazyScrollBottom+55)||k){if(this.loadingRow){var n=this;this.loadingRow.hide();if(this.p.lockColumn){this.loadingRow2.hide()}if(this.p.lockColumnR){this.loadingRow3.hide()}if(!this.p.hasGroup){var q=this.addRow(this.data[this.lazyRowNo],this.getRowNoL(),null,true,null,null,this.pageNo);for(var h=0,p=this.p.columns,f=p.length;h<f;h++){if(p[h].isHide){this.hideColumnR(q,h,false)}}}else{var o=[];this.addRowGS(this.data[this.lazyRowNo],this.getRowNoL(),this.pageNo,null,null,null,o);if(o.length>0){for(var h=0,p=this.p.columns,f=p.length;h<f;h++){if(p[h].isHide){for(var g=0,e=o.length;g<e;g++){this.hideColumnR(o[g],h,false)}}}}}this.syncRowHeightR(this.lazyRowNo);this.lazyRowNo++;if(this.p.isPageCache){this.getPageCache(this.pageNo)[6]=this.lazyRowNo}if(this.lazyRowNo<=this.data.length-1){this.addLoadingRow()}}return true}else{return false}},autoLoadlazyRow:function(h,e){if(this.p.isLazyLoad){var g=this;var f=function(){for(var k=0,j=g.data.length;k<j;k++){if(g.lazyRowNo>j-1){g.divOut.attr("title","");break}if(!g.lazyAddRow(h)){break}g.setMainHeight()}g.joinCacheData()};if(e){d.lazyDo(function(){f()},e,"ld_dgjALllr",this)}else{f()}}},addPageCache:function(g,f,e){if(this.p.isPageCache){var h=[g,this.data,this.tbody,this.chks,this.tbody2,this.tbody3,this.p.isLazyLoad?this.lazyRowNo:null,this.rows,f,e];this.pageCache.push(h);return h}},getPageCache:function(f){var g=false,h=this.pageCache;if(this.p.isPageCache){for(var j=0,e=h.length;j<e;j++){if(h[j][0]==f){g=h[j];break}}}return g},clearPageCache:function(){if(this.p.isPageCache){this.pageCache=[];this.datas=[];var g=this.table.find("tbody:hidden");if(g.length>0&&g.children("tr").length>0){g.remove()}if(this.p.lockColumn){var f=this.table2.find("tbody:hidden");if(f.length>0&&f.children("tr").length>0){f.remove()}}if(this.p.lockColumnR){var e=this.table3.find("tbody:hidden");if(e.length>0&&e.children("tr").length>0){e.remove()}}}},joinCacheData:function(){if(this.p.isPageCache){this.datas=[];var f=this.pageCache;for(var g=0,e=f.length;g<e;g++){b.merge(this.datas,f[g][1])}}},hideColumn:function(o,f,e){if(!f&&!e&&this.headContainer.find("div.dgj_tdDiv:hidden").length>=this.p.columns.length-1){return false}var j=this;var n=o;if(this.p.hasChk){n+=1}var l="hide",p=this.p.filterTag?",tr["+this.p.filterTag+"]":"",m=p?":not(td["+this.p.filterTag+"])":"";if(f){l="show"}var i=this.getColType(o);switch(i){case 0:this.tableHead.find("th").eq(n)[l]();this.table.find("tr:not(tr[loading],tr[groupRow],tr[emptyRow]"+p+")").each(function(q){var k=b(this);if(!k.hasClass("dgj_trG1")){k.find("td"+m).eq(n)[l]()}});if(this.p.hasGridFoot){this.trF.find("td").eq(n)[l]()}if(this.p.canColumeDD){this.colDDs[o][l]();var h=this.sbj.getScrollLeft();if(h>0){this.sbj.setScrollLeft(h+1);this.sbj.setScrollLeft(h-1)}else{this.setDDPosition()}}this.setSbjWidth(true);this.setMainHeight();if(j.p.collapseSonRow){j.tbody.find("div.dgj_tdDiv").eq(j.p.hasChkG?1:0).width(j.tableHead.width()-j.p.chkWidth-j.shiftG)}break;case 1:this.tableHead.find("th").eq(n)[l]();this.table.find("tr:not(tr[loading],tr[emptyRow]"+p+")").each(function(k){b(this).find("td"+m).eq(n)[l]()});if(this.p.isLazyLoad){if(this.loadingRow){if(this.table.find("td:visible").length<=1){this.loadingRow.hide()}else{if(this.lazyRowNo<=this.data.length-1){this.loadingRow.show()}}}if(!this.p.asyncLoadTree){d.lazyDo(function(){this.syncRowHeightB()},500,"ld_dgjSyncRH",this)}}if(this.p.canColumeDD){this.colDDs[o][l]()}this.setLockWidth();this.setDDPosition();this.setLockWidth();this.sbj.left(this.table.width());break;case 2:var g=o-this.p.lockColumn+1;this.tableHead2.find("th").eq(g)[l]();this.table2.find("tr:not(tr[loading],tr[emptyRow]"+p+")").each(function(k){b(this).find("td"+m).eq(g)[l]()});if(this.p.isLazyLoad){if(this.loadingRow){if(this.table2.find("td:visible").length<=1){this.loadingRow2.hide()}else{if(this.lazyRowNo<=this.data.length-1){this.loadingRow2.show()}}}if(!this.p.asyncLoadTree){d.lazyDo(function(){this.syncRowHeightB()},500,"ld_dgjSyncRH",this)}}if(this.p.canColumeDD){this.colDDs[o][0][l]();this.colDDs[o][1][l]()}this.setDDPosition(true);this.setLockWidth();var h=this.sbj.getScrollLeft();if(h>0){this.sbj.setScrollLeft(h+1);this.sbj.setScrollLeft(h-1)}else{this.setDDPosition(true)}break;case 3:var g=o-this.p.lockColumnR+1;this.tableHead3.find("th").eq(g)[l]();this.table3.find("tr:not(tr[loading],tr[emptyRow]"+p+")").each(function(k){b(this).find("td"+m).eq(g)[l]()});if(this.p.isLazyLoad){if(this.loadingRow){if(this.table3.find("td:visible").length<=1){this.loadingRow3.hide()}else{if(this.lazyRowNo<=this.data.length-1){this.loadingRow3.show()}}}if(!this.p.asyncLoadTree){d.lazyDo(function(){this.syncRowHeightB()},500,"ld_dgjSyncRH",this)}}if(this.p.canColumeDD){this.colDDs[o][l]()}this.setLockWidth();this.sbj.left(this.table.width());this.setDDPosition();this.setLockWidth();break}return true},hideColumnR:function(i,h,g){var f;if(!b.isArray(i)){f=i}else{f=i[0]}if(f.attr("emptyRow")){return}var m=h;if(this.p.hasChk){m+=1}var l="hide";if(g){l="show"}var j=this.getColType(h);switch(j){case 0:if(!f.hasClass("dgj_trG1")){f.find("td").eq(m)[l]()}break;case 1:f.find("td").eq(m)[l]();break;case 2:var e=h-this.p.lockColumn+1;i[1].find("td").eq(e)[l]();break;case 3:var e=h-this.p.lockColumnR+1;i[2].find("td").eq(e)[l]();break}},hideColumnMenu:function(m,h,f){if(!this.hideColumn(m,h)){if(f){f.setChecked(true,null,true)}}else{this.p.columns[m].isHide=!h;if(this.p.storeName){var j=[];for(var g=0,k=this.p.columns,e=k.length;g<e;g++){if(k[g].isHide){j.push(g)}}d.LocalStorage.setItem({key:this.p.storeName+"_hide",value:JSON.stringify(j)})}}},hideColumnD:function(){if(this.p.defaultHideColumn.length>0){var h=this.p.columns;for(var f=0,g=this.p.defaultHideColumn,e=g.length;f<e;f++){var j=g[f];h[j].isHide=true}}},renderTable:function(i,e,f,l){var j=this;var o=[],n,m;if(this.p.lockColumn){n=[]}if(this.p.lockColumnR){m=[]}this.renderRows(o,n,m,i,e,f,null);this.mainContainer[0].innerHTML=o.join("");this.table=b("#dgj_table_"+this.objId);this.tbody=b("#dgj_tbody_"+this.objId);if(n){this.lcContainer[0].innerHTML=n.join("");this.table2=b("#dgj_table2_"+this.objId);this.tbody2=b("#dgj_tbody2_"+this.objId)}if(m){this.rightContainer[0].innerHTML=m.join("");this.table3=b("#dgj_table3_"+this.objId);this.tbody3=b("#dgj_tbody3_"+this.objId)}var k=this.table.find("tr.dgj_tr1"),h,g;if(n){h=this.table2.find("tr.dgj_tr2")}if(m){g=this.table3.find("tr.dgj_tr3")}k.each(function(p){var q=k.eq(p),s,r;if(h){s=h.eq(p)}if(g){r=g.eq(p)}j.setRowColor(p,q,s,r,i[p].checked)})},renderRows:function(y,f,e,A,B,w,p){var z=this;var g=this.headContainer.find("div.dgj_tdDiv");if(this.p.hasChk){g=g.not("div:first")}y[y.length]='<table id="dgj_table_'+this.objId+'" class="dgj_table1"><tbody id="dgj_tbody_'+this.objId+'">';if(f){f[f.length]='<table id="dgj_table2_'+this.objId+'" class="dgj_table2" style="margin-left:-1px;" ><tbody id="dgj_tbody2_'+this.objId+'">'}if(e){e[e.length]='<table id="dgj_table3_'+this.objId+'" class="dgj_table3"><tbody id="dgj_tbody3_'+this.objId+'">'}for(var u=0,s=A.length;u<s;u++){var h=A[u],x=u;for(var q in h){if(h[q]==null){h[q]=""}}if(!h.checked){h.checked=false}y[y.length]='<tr class="dgj_tr1 dgj_trB_'+(!this.p.hasGroup?x:p)+(!B?"":("_"+B))+'">';if(f){f[f.length]='<tr class="dgj_tr2 dgj_trB_'+x+(!B?"":("_"+B))+'"></tr>'}if(e){e[e.length]='<tr class="dgj_tr3 dgj_trB_'+x+(!B?"":("_"+B))+'"></tr>'}if(this.p.hasChk&&w){y[y.length]='<td chkCell="true" style="text-align:center;height:'+this.p.defaultH+'px;">';y[y.length]='<div chkCellDiv="true" class="dgj_tdDiv" style="width:'+this.p.chkWidth+'px;">';y[y.length]='<input chkCell="true" type="checkbox" '+(h.checked?"checked":"")+" />";y[y.length]="</div></td>"}for(var t=0,k=this.p.columns,r=k.length;t<r;t++){var v;var n=this.getColType(t);switch(n){case 0:case 1:v=y;break;case 2:v=f;break;case 3:v=e;break}(function(j,i){z.fire("preColumnRender",{rowData:h});v[v.length]='<td colId="'+t+'" style="height:'+z.p.defaultH+"px;text-align:"+(j.align?j.align:z.p.defaultAlign)+';" >';v[v.length]='<div class="dgj_tdDiv" style="width:'+(z.p.noGridBorder?i+1:i)+'px;">';v[v.length]=!j.renderFn?h[j.dataIndex]:j.renderFn.call(z,h[j.dataIndex],h,x);v[v.length]="</div></td>"})(k[t],parseInt(g.eq(t)[0].style.width,10))}y[y.length]="</tr>";if(f){f[f.length]="</tr>"}if(e){e[e.length]="</tr>"}}y[y.length]="</tbody></table>";if(f){f[f.length]="</tbody></table>"}if(e){e[e.length]="</tbody></table>"}return this},addRow:function(aa,an,P,M,B,e,w,ah,F){var f=this,p,y=this.p.isTreeGrid,q=this.p.autoNo;if(an==null){p=1;M=1;if(this.isDataEmpty()){this.tbody.empty();if(this.p.lockColumn){this.tbody2.empty()}if(this.p.lockColumnR){this.tbody3.empty()}this.addPageCache(this.pageNo)}if(!this.p.isLazyLoad){an=this.data.lengthD}else{an=this.getRowNoL()}this.data.push(aa);this.data.lengthD++;if(this.p.isLazyLoad){this.lazyRowNo++;if(this.p.isPageCache){this.getPageCache(this.pageNo)[6]=this.lazyRowNo}}this.joinCacheData()}for(var ab in aa){if(aa[ab]==null){aa[ab]=""}}if(!F){F={}}if(q){aa[q]=an+1+((w!=null&&this.pageSize)?(w-1)*this.pageSize:0)}var R=null,E,D,u,n=F.parentId?F.parentId:"root",K=f.p.idField;if(this.p.hasGroup){u=B}else{if(y){u=(F.parentId?F.parentId+"_":"")+aa[this.p.idField]+"_";aa.nodeNo=u}else{u=an}}u+=!w?"":("_"+w);R=b('<tr class="dgj_tr1 dgj_trB_'+u+'"></tr>');if(y){R.attr({nodeNo:u,parentNo:n,deep:F.deep,path:F.path});if(aa.isCheck==null){aa.isCheck=0}aa.nodePath=F.path}if(this.p.hasGroup){R.attr("rowNo",B+"_"+an+(!w?"":("_"+w)))}if(this.p.collapseSonRow&&(e&&!e.checked)){R.hide()}if(this.p.lockColumn){E=b('<tr class="dgj_tr2 dgj_trB_'+u+'"></tr>');if(y){E.attr({nodeNo:u,parentNo:n,deep:F.deep,path:F.path})}}if(this.p.lockColumnR){D=b('<tr class="dgj_tr3 dgj_trB_'+u+'"></tr>');if(y){D.attr({nodeNo:u,parentNo:n,deep:F.deep,path:F.path})}}if(!aa.checked){aa.checked=false}var N=document.createDocumentFragment(),i,g;if(this.p.lockColumn){i=document.createDocumentFragment()}if(this.p.lockColumnR){g=document.createDocumentFragment()}var J,al,G=!w?"":("_"+w);if(B!=null){al=B+"_"+an+G}else{if(!y){al=an+G}else{al=F.path+G}}if(this.p.hasChk){var L=b('<td chkCell="true" style="text-align:center;height:'+f.p.defaultH+"px;"+(!this.p.hideChk?"":"display:none;")+'"><div chkCellDiv="true" class="dgj_tdDiv dgj_chkDiv" style="width:'+this.p.chkWidth+'px"></div></td>');var aj,T=L[0];if(T.firstElementChild){aj=b(T.firstElementChild)}else{aj=b(T.firstChild)}if(M){(function(k,j,h){J=b('<input id="chkRow_'+j+"_"+f.objId+'" '+(k.checked?"checked":"")+' type="checkbox" hidefocus />');if(f.p.chkStyle){J.sbxj=J.SBXJ({initClass:"dgj_chkC",type:f.p.chkCollapse?"collapse":null,canQuery:false,isInitHide:false,evts:{beforeClick:function(m,l){return l.param&&(l.param.isClickRow||l.param.isAllCheck)?!l.checked:l.checked}}});aj.append(J.sbxj.divOut)}else{aj.append(J)}J.click(function(o,m){o.stopPropagation();if(this.paramJ!=null){m=this.paramJ;this.paramJ=undefined;try{delete this.paramJ}catch(l){}}f.check(!y?an:F.path,k,m,J,w)});if(y){aa[f.p.nodeChkField]=J}else{h.push(J)}})(aa,al,f.chks)}N.appendChild(T)}this.setRowColor(an,R,E,D,aa.checked);if(!P){this.tbody.append(R)}else{if(!b.isArray(P)){P.after(R)}else{P[0].after(R)}}if(this.p.lockColumn){if(!P){this.tbody2.append(E)}else{P[1].after(E)}}if(this.p.lockColumnR){if(!P){this.tbody3.append(D)}else{P[2].after(D)}}var s;if(!this.p.hasGroup&&this.p.lockColumn){if(this.p.lockColumn){if(!this.p.lockColumnR){s=R.add(E)}else{s=R.add(E).add(D)}}}else{s=R}this.setRowHL(s);if(this.p.hasRowContextMenu){s.bind("contextmenu",function(k){if(!ah&&(!f.p.hasChk||!f.p.canSelectRowR)){if(f.pasteRow){f.pasteRow.removeAttr("pasteRow")}f.pasteRow=R;R.attr("pasteRow",true);if(y){f.currentNode=aa}}else{if(ah&&(!f.p.hasChkG||!f.p.canSelectRowR)){if(f.pasteRowG){f.pasteRowG.removeAttr("pasteRowG")}f.pasteRowG=ah;ah.attr("pasteRowG",true)}else{if(J&&!J[0].checked&&f.p.hasChk&&f.p.canSelectRowR){var j=k.srcElement?k.srcElement:k.target,l=b(j);if(!l.hasClass("dgj_chkC")){var h={isClickRow:true};J[0].paramJ=h;J.trigger("click",h)}}}}})}if(this.p.hasChk&&this.p.canSelectRow&&J){s.onGestureJ(c.Evt.click,function(m,l){var h=l.evt,k=h.srcElement?h.srcElement:h.target,v=b(k);if(!v.hasClass("dgj_chkC")){var j={isClickRow:true};J[0].paramJ=j;J.trigger("click",j)}},{preventClick:false})}var W;if(F&&F.thds){W=F.thds}else{W=this.headContainer.find("div.dgj_tdDiv");if(this.p.hasChk){W=W.not("div:first")}}var ap=[],z=[],t=[],Q=[],Z=this.p.cellPadding,O=this.p.cellInnerPadding;for(var ag=0,C=this.p.columns,ae=C.length;ag<ae;ag++){var ak,r,ao=0,Y=this.getColType(ag),am=C[ag];switch(Y){case 0:case 1:if(ag==0&&f.p.lockColumn){ao=1}else{ao=0}ak=R;r=N;break;case 2:if(ag-f.p.lockColumn+1==0){ao=1}else{ao=0}ak=E;r=i;break;case 3:if(ag-f.p.lockColumnR+1==0){ao=1}else{ao=0}ak=D;r=g;break}t[t.length]=ak;if(ak){(function(aA,aD){f.fire("preColumnRender",{rowData:aa,colNo:ag});var at=c.RX.percent(aA.width)?aA.width:"",m=b('<td colId="'+ag+'" style="'+(f.p.nodeWrap?"white-space:normal;":"")+(Z!=null?"padding:"+(c.RX.numZ2(Z)?Z+"px":Z)+";":"")+"height:"+f.p.defaultH+"px;"+(at!==""?("width:"+at+";"):"")+"text-align:"+(function(){var aE;if(aA.isTreeField){aE="left"}else{if(aA.align){aE=aA.align}else{aE=f.p.defaultAlign}}return aE})()+';"><div '+(f.p.isTree?"":'style="width:'+(!f.p.isHideHead?((f.p.noGridBorder&&!ao)?aD+1:aD)+"px":(at===""?(aA.width?aA.width+"px":"auto"):"100%"))+";")+(O!=null?"padding:"+(c.RX.numZ2(O)?O+"px":O)+";":"")+'" class="dgj_tdDiv"></div></td>');var k,ay=m[0];if(ay.firstElementChild){k=b(ay.firstElementChild)}else{k=b(ay.firstChild)}r.appendChild(ay);Q[Q.length]=[m,k];if(!aA.isAsyncLoad||aa.stopAsyncLoad){var ax="",v,ar,o,aC;if(aA.editable&&!aA.isTreeField){ay.style.padding="0px";k[0].style.padding="0px 5px 0px 1px";k.attr("editable",true);switch(aA.editType){case"sel":aC={};o=b('<select class="dgj_editSel" '+(aA.hideEditTxt?'style="display:none;"':"")+" >"+(function(){var aH="";for(var aG=0,aE=aA.editCbxData.length;aG<aE;aG++){var aF=aA.editCbxData[aG];aH+='<option value="'+aF.value+'">'+aF.text+"</option>";aC[aF.value]=aF.text}return aH})()+"</select>");break;case"textarea":o=b('<textarea class="dgj_editTextarea" '+(aA.hideEditTxt?'style="display:none;"':"")+" ></textarea>");break;case"txt":default:o=b('<input type="text" class="dgj_editTxt" '+(aA.hideEditTxt?'style="display:none;"':"")+" />");break}if(aA.editHeight!=null){o.css("height",aA.editHeight)}k.append(o);if(!aa.editCell){aa.editCell=[]}ar=[o,null,aA.hideEditTxt?false:true,aA.dataIndex,aA.editFilter,aC];aa.editCell.push(ar)}if(!aA.renderFn){ax=aa[aA.dataIndex];if(aA.editable){o.val(ax);ax=b("<span editable='true' "+(!aA.hideEditTxt?"style='display:none;'":"")+">"+ax+"</span>");ar[1]=ax}}else{v=[k,aA.renderFn,aa[aA.dataIndex],ag,ar,aA.hideEditTxt,m,aA];z.push(v)}if(aA.isTreeField){var aq=b("<div></div>").css({marginLeft:f.p.nodeMarginL+F.deep*f.p.nodeDeepRetract});var l=b("<span class='dgj_nodeWrap'></span>");l.click(function(aE){f.fire("cilckNode",{node:aa})});var aB;if(f.p.hasChkT){var av=function(aF,aE){f.cascade(aF,function(aG){aG.isCheck=aE;if(aG._chkT){aG._chkT.setChecked(aE,null,true)}if(aG.isLeaf){return false}})};k.addClass("dgj_chkDiv");aB=SBXJ.init({inputId:"dgj_chkT_"+al+"_"+f.objId,initChecked:aa.isCheck,initClass:"dgj_chkC",canQuery:false,style:"margin-right:2px;",evts:{onChecked:function(aH,aG){var aF=aG.checked?1:0,aE=f.p.nodeIndex;av(aa,aF);f.bubble(aa,function(aP){var aK=aP[aE],aM=aP.isCheck,aO=true,aJ;for(var aN=0,aI=aK.length;aN<aI;aN++){var aL=aK[aN];if((aF===1&&aL.isCheck!==1)||(aF===0&&aL.isCheck!==0)){aO=false;break}}if(aO){aJ=aF}else{aJ=2}aP.isCheck=aJ;aP._chkT.setChecked(aJ,null,true);if(aJ===aM){return false}},true)}}});aa._chkT=aB}var au=aa.isExpand?true:false;R.attr({visible:F.expand,expand:au});if(f.p.lockColumn){E.attr({visible:F.expand,expand:au})}if(f.p.lockColumnR){D.attr({visible:F.expand,expand:au})}var j=b(f.blankImg),h,az=SBXJ.init({inputId:"nodeIcon_"+f.objId+"_"+u,initChecked:au,initClass:"dgj_chkC",cNameCheckedDisabled:f.p.isShowNodeImg?null:"dgj_loadingT",type:"collapse",canQuery:false,style:"margin-right:2px;",evts:{onChecked:function(aJ,aF){var aK=this,aM=aF.isClickRow?!aF.checked:aF.checked;aa.isExpand=aM;R.attr("expand",aM);if(f.p.lockColumn){E.attr("expand",aM)}if(f.p.lockColumnR){D.attr("expand",aM)}if((f.p.asyncLoadTree||f.p.treeLocalLazy)&&!aa.complete){this.setDisabled(true);h.swapClassJ("dgj_folderOpen dgj_folderClose","dgj_loadingT");f.loadDataTAsync(false,{node:aa,pId:u.substr(0,u.length-1),deep:F.deep,path:F.path,trs:[R,E,D]},function(aN){aa.complete=true;if(aN){aK.show(true);j.hide();h.swapClassJ("dgj_loadingT dgj_leaf","dgj_folderOpen");if(f.p.hasChkT){var aO=aa.isCheck?1:0;av(aa,aO)}}else{aK.hide();if(!f.p.hideImgB){j.show()}h.swapClassJ("dgj_loadingT dgj_folderClose dgj_folderOpen","dgj_leaf");aa.isLeaf=true}aK.setDisabled(false)},!f.p.treeLocalLazy?null:aa[f.p.nodeIndex])}else{var aG=f.gridContainer.find("tr[nodeNo^="+u+"]");var aH={};var aE={};var aL=function(aO){aO=aO.substr(0,aO.length-1);if(aO.indexOf("_")!=-1){var aN=aO.substr(0,aO.lastIndexOf("_"))+"_";if(aH[aN]){return false}else{return aL(aN)}}else{return true}};var aI=[];aG.each(function(){var aP=b(this),aQ=aP.attr("nodeNo");if(aQ!=u){var aO=aQ.split("_").length==(u.split("_").length+1);if(aM){var aN=0;if(aE[aQ]==null){if(aO){aN=1}else{if(aP.attr("visible")+""=="true"&&aL(aQ)){aN=1}else{aH[aQ]=1}}aE[aQ]=aN}else{aN=aE[aQ]}if(aN){aP.attr("visible",true);if(!f.p.collapseAnimate){aP.show()}else{aI.push(aP[0])}}}else{if(aO){aP.attr("visible",false)}if(!f.p.collapseAnimate){aP.hide()}else{aI.push(aP[0])}}}if(aP.attr("expand")+""=="false"){aH[aQ]=1}});aH=null;aE=null;if(!f.p.collapseAnimate){f.setMainHeight()}else{f.collapseAnimWrap(aM,aG.eq(0),b(aI))}if(aM){h.swapClassJ("dgj_folderClose","dgj_folderOpen")}else{h.swapClassJ("dgj_folderOpen","dgj_folderClose")}}}}});if(aa[f.p.nodeIndex]||(f.p.asyncLoadTree&&!aa.isLeaf)){j.hide();h=b('<img class="dgj_tgImg '+(au?"dgj_folderOpen":"dgj_folderClose")+'" style="margin-right:2px;'+(!f.p.isShowNodeImg?"display:none;":"")+'" src="'+c.imgPath+'Datagrid/treegrid/s.gif" />')}else{aa.isLeaf=true;if(f.p.hideImgB){j.hide()}az.hide();h=b('<img class="dgj_tgImg dgj_leaf" style="margin-right:2px;'+(!f.p.isShowNodeImg?"display:none;":"")+'" src="'+c.imgPath+'Datagrid/treegrid/s.gif" />')}aa.nodeIcon=az;aa.nodeImg=h;k.css("overflow","visible");aq.append(az.divOut);aq.append(j).append(h);if(aB){aq.append(aB.divOut)}k.append(aq.append(l.append(ax)));if(aA.renderFn){v[0]=l}if(!f.p.asyncLoadTree&&!f.p.treeLocalLazy){var aw=true;f.bubble(aa,function(aE){if(aw){aw=false;return}if(!aE.isExpand){R.hide();if(f.p.lockColumn){E.hide()}if(f.p.lockColumnR){D.hide()}return false}})}}else{k.append(ax)}}else{k.append(LMJ.getLoadImg(3,true));m.css("text-align","center");k.attr("alignTmp",aA.align)}if(aA.asyncLoadFn){ap.push([aA.asyncLoadFn,aa[aA.dataIndex],ag])}})(am,(function(){var o=W.eq(ag),l=o.attr("mergecell"),j=parseInt(o[0].style.width,10);if(!l){return j}else{var m;for(var k=1;k<l;k++){o=W.eq(ag-k);m=C[ag-k];j-=parseInt(o[0].style.width,10)+(!m.editable?4:6)+(f.p.noGridBorder?1:0)}return j}})())}}R[0].appendChild(N);if(this.p.lockColumn){E[0].appendChild(i)}if(this.p.lockColumnR){D[0].appendChild(g)}for(var ag=0,C=this.p.columns,ae=C.length;ag<ae;ag++){var am=C[ag];if(am.mergeCell){this.mergeCell(am.mergeCell,ag,t[ag])}if(am.sortRows!=null&&b.inArray(an,am.sortRows)!=-1){this.setCellSort(ag,am,Q[ag][0],Q[ag][1])}}for(var af=0,ae=z.length;af<ae;af++){var V=z[af],A=V[4],X=null;if(!this.p.useObjParam){X=V[1].call(f,V[2],aa,an,B,e,w,R,E,D,V[3],J,A,V[6],V[0],V[7])}else{X=V[1].call(f,{value:V[2],data:aa,rowNo:an,noG:B,dataG:e,pageNo:w,tr:R,tr2:E,tr3:D,colNo:V[3],chk:J,editElem:A,td:V[6],tdDiv:V[0],col:V[7]})}if(A){var ad=b("<span editable='true' "+(!V[5]?"style='display:none;'":"")+">"+X+"</span>");A[1]=ad;A[0].val(X);V[0].append(ad)}else{V[0].prepend(X)}}for(var af=0,ae=ap.length;af<ae;af++){var I=ap[af];I[0].call(f,I[1],aa,an,I[2],w,R,E,D,B,e)}if(B!=null){if(!ah){this.rows[B].rows.push(R)}else{for(var ai=0,ae=this.rows.length;ai<ae;ai++){if(this.rows[ai].trG==ah){this.rows[ai].rows.push(R)}}}}if(p){d.lazyDo(function(){this.setTableWidth();this.setMainHeight()},200,"ld_dgjAddRow",this)}if(y){var H=true;if(this.p.treeLocalLazy){if(aa.isExpand){aa.complete=true}else{aa.complete=false;H=false}}if(H){var U=aa[this.p.nodeIndex];if(U){for(var ac=0,ae=U.length;ac<ae;ac++){var x={thds:W};var S=U[ac][this.p.idField];if(S==null){U[ac][this.p.idField]="dgjTg_"+new Date().getTime()+Math.random()}x.parentId=u.substr(0,u.length-1);x.deep=F.deep+1;x.path=F.path+ac+".";x.expand=aa.isExpand;U[ac].parentNode=aa;this.addRow(U[ac],0,null,true,null,null,null,null,x)}}}}if(!this.p.lockColumn){return R}else{if(!this.p.lockColumnR){return[R,E]}else{return[R,E,D]}}},removeRow:function(e,h,l,j,i,m,f){var k,n;if(!h){k=this.data[e];n=e}else{k=h;n=b.inArray(h,this.data)}this.fire("beforeRemoveRow",{rowData:k,rowNo:n});if(!h){if(!this.p.compatibleMode){c.arr.removeAt(this.data,n);if(this.p.hasChk){c.arr.removeAt(this.chks,n)}}else{this.data[n]=null;if(this.p.hasChk){this.chks[n]=null}}var g="tr:not(tr[loading]):eq("+n+")";this.tbody.find(g).remove();if(this.p.lockColumn){this.tbody2.find(g).remove()}if(this.p.lockColumnR){this.tbody3.find(g).remove()}}else{if(!this.p.compatibleMode){c.arr.removeAt(this.data,n);if(this.p.hasChk){c.arr.removeAt(this.chks,n)}}else{this.data[n]=null;if(this.p.hasChk){this.chks[b.inArray(m,this.chks)]=null}}l.remove();if(j){j.remove()}if(i){i.remove()}}if(!this.p.compatibleMode){if(this.p.isLazyLoad){this.lazyRowNo--}}if(this.isDataEmpty()){this.clearData()}else{this.setMainHeight()}this.fire("afterRemoveRow",{rowNo:n});if(this.p.isLazyLoad){this.autoLoadlazyRow()}},addRowG:function(h,e,p,f,k,q){var l=this;var o=e+(!f?"":("_"+f));var j=b('<tr groupRow="true" class="dgj_trG1 dgj_trGB_'+o+'" rowNum="'+o+'"></tr>');if(this.p.groupRowH){j.height(this.p.groupRowH)}if(!h.checked){h.checked=false}var n;if(this.p.hasChkG){var m=b('<td chkCellG="true" style="text-align:center;"></td>');var s=b('<div chkCellDivG="true" class="dgj_tdDiv dgj_chkDiv"></div>').css({width:this.p.chkWidth});n=b('<input id="chkRowG_'+o+"_"+l.objId+'" title="" type="checkbox" hidefocus />');n[0].checked=h.checked;if(this.p.chkStyle){n.sbxj=n.SBXJ({initClass:"dgj_chkC",type:l.p.chkCollapse?"collapse":null,canQuery:false,isInitHide:false,evts:{beforeClick:function(u,t){return t.param&&(t.param.isClickRow||t.param.isAllCheck)?!t.checked:t.checked}}});s.append(n.sbxj.divOut)}else{s.append(n)}n.click(function(v,u){v.stopPropagation();if(this.paramJ!=null){u=this.paramJ;this.paramJ=undefined;try{delete this.paramJ}catch(t){}}l.check(e,h,u,n,f)});m.append(s);j.append(m);if(!q){l.chks.push(n)}else{l.chks.unshift(n)}if(this.p.hasRowContextMenu){j.bind("contextmenu",function(v){if(!l.p.hasChkG||!l.p.canSelectRowR){if(l.pasteRowG){l.pasteRowG.removeAttr("pasteRowG")}l.pasteRowG=j;j.attr("pasteRowG",true)}else{if(!n[0].checked&&l.p.hasChkG&&l.p.canSelectRowR){var u=v.srcElement?v.srcElement:v.target;if(!b(u).hasClass("dgj_chkC")){var t={isClickRow:true};n[0].paramJ=t;n.trigger("click",t)}}}})}if(this.p.canSelectRow){j.css("cursor","pointer").bind("click",function(v){var u=v.srcElement?v.srcElement:v.target;if(!b(u).hasClass("dgj_chkC")){var t={isClickRow:true};n[0].paramJ=t;n.trigger("click",t)}})}}var i=b('<td colspan="'+this.p.columns.length+'"></td>');var r=b('<div class="dgj_tdDiv"></div>');j.append(i.append(r.append(this.p.renderGroupRow.call(this,h,e,f,j,n))));if(k){j.css("background-color",this.p.colorParams.newRow).attr("spRowColor",this.p.colorParams.newRow)}this.setRowColorG(e,j,h.checked);if(!p){if(!q){this.tbody.append(j)}else{this.tbody.prepend(j)}}else{p.after(j)}this.setRowHL(j);var g={trG:j,rows:[]};if(!q){this.rows.push(g)}else{this.rows.unshift(g)}return j},addRowGS:function(i,e,f,o,t,u,v,r){if(this.isDataEmpty()){this.tbody.empty()}if(e==null){if(!this.p.isLazyLoad){e=this.data.lengthD}else{e=this.getRowNoL()}if(!t){this.data.push(i)}else{this.data.unshift(i)}this.data.lengthD++;if(this.p.isLazyLoad){this.lazyRowNo++;if(this.p.isPageCache){this.getPageCache(this.pageNo)[6]=this.lazyRowNo}}this.joinCacheData()}var p=this;var n=this.addRowG(i,e,u,f,o,t);var q=n;var m=[];if(this.p.asyncLoadSonRow){this.p.renderSonRow.call(this,e,n)}else{var g=i[this.p.sonRowName];if(g&&g.length>0){for(var k=0,h=g.length;k<h;k++){n=this.addRow(g[k],k,n,false,e,i,f,q,r);m.push(n);if(v){v.push(n)}}}}d.lazyDo(function(){this.setTableWidth();this.setMainHeight()},200,"ld_dgjGS",this);this.fire("afterAddRowGS",{rowData:i,rowNo:e,pageNo:f});var s;if(m.length>0){s=m[m.length-1]}else{s=n}return s},removeRowG:function(e,k,q,r,f){var o,s;if(!k){o=this.data[e];s=e}else{o=k;s=b.inArray(k,this.data)}this.fire("beforeRemoveRowG",{rowData:o,rowNo:s});if(!k){if(!this.p.compatibleMode){c.arr.removeAt(this.data,s);if(this.p.hasChk){c.arr.removeAt(this.chks,s)}}else{this.data[s]=null;if(this.p.hasChk){this.chks[s]=null}}var t=this.rows[s];t.trG.remove();for(var n=0,j=t.rows.length;n<j;n++){t.rows[n].remove()}}else{if(!this.p.compatibleMode){c.arr.removeAt(this.data,s);if(this.p.hasChk){c.arr.removeAt(this.chks,s)}}else{this.data[s]=null;if(this.p.hasChk){this.chks[b.inArray(r,this.chks)]=null}}q.remove();for(var p=0,j=this.rows.length;p<j;p++){var t=this.rows[p];if(t.trG==q){for(var n=0,g=t.rows.length;n<g;n++){t.rows[n].remove()}break}}}if(!this.p.compatibleMode){c.arr.removeAt(this.rows,s);if(this.p.isLazyLoad){this.lazyRowNo--}}if(this.isDataEmpty()){this.clearData()}else{this.setRowWidthG()}this.fire("afterRemoveRowG",{rowNo:s});if(this.p.isLazyLoad){this.autoLoadlazyRow()}},setCellData:function(s,h,u,v,x,w,g,p,o,m){if(this.isDataEmpty()){return}var t=this;var r=h;if(this.p.hasChk){r+=1}if(!g){if(!this.p.isPageCache){this.data[s][u]=v}else{var i=this.getPageCache(x);if(i){i[1][s][u]=v}else{this.data[s][u]=v}}}else{g[u]=v;s=b.inArray(g,this.data)}var f,q=this.getColType(h);switch(q){case 0:case 1:if(!g){var e;if(!this.p.isPageCache){e=this.tbody}else{var i=this.getPageCache(x);if(i){e=i[2]}else{e=this.tbody}}f=e.find("tr:not(tr[loading])").eq(s).find("div.dgj_tdDiv").eq(r)}else{f=p.find("div.dgj_tdDiv").eq(r)}break;case 2:var n=h-this.p.lockColumn+1;if(!g){var l;if(!this.p.isPageCache){l=this.tbody2}else{var i=this.getPageCache(x);if(i){l=i[4]}else{l=this.tbody2}}f=l.find("tr:not(tr[loading])").eq(s).find("div.dgj_tdDiv").eq(n)}else{f=o.find("div.dgj_tdDiv").eq(n)}break;case 3:var n=h-this.p.lockColumnR+1;if(!g){var j;if(!this.p.isPageCache){j=this.tbody3}else{var i=this.getPageCache(x);if(i){j=i[5]}else{j=this.tbody3}}f=j.find("tr:not(tr[loading])").eq(s).find("div.dgj_tdDiv").eq(n)}else{f=m.find("div.dgj_tdDiv").eq(n)}break}if(f.attr("alignTmp")){f.css("text-align",f.attr("alignTmp"))}if(!w){f.html(v)}else{f.html(w)}if(this.p.lockColumn){this.syncRowHeightR(s,p,o,m)}d.lazyDo(function(){this.setMainHeight()},500,"ld_dgjCell",this)},mergeCell:function(g,e,f){this.mergeCellFn(g,e,f)},mergeCellH:function(g,e,f){this.mergeCellFn(g,e,f,"th")},mergeCellFn:function(r,n,u,g){if(!g){g="td"}if(n>0){var q=u.find(g+":not("+g+"[chkCell]):lt("+(n+1)+")");var p=n+1-r,m=n;var s,t=0;for(var o=0,f=q.length;o<f;o++){if(m==n){q.eq(m).attr("colspan",r).find("div.dgj_tdDiv").attr("mergeCell",r);s=q.eq(m).find("div.dgj_tdDiv");t+=s.width()}else{var e=q.eq(m).find("div.dgj_tdDiv");t+=e.width()+this.p.mcShift;e.attr("mergeCellH",r).attr("mergeCellN",n);q.eq(m).hide()}if(m<=p){break}m--}s.width(t)}},mergeCellV:function(){if(!this.p.isMergeCellV){return}var q,f=true,s,o;for(var x=0,i=this.p.columns,v=i.length;x<v;x++){var g=i[x],e,p;if(!g.mergeCellV){continue}else{p=this.getColType(x);switch(p){case 0:case 1:e=this.tbody;break;case 2:e=this.tbody2;break;case 3:e=this.tbody3;break}if(f){s=this.p.filterTag?"tr["+this.p.filterTag+"]":"";q=e.find("tr:not(tr[loading]"+(s?","+s:"")+")");o=function(k,j,C){k[j].attr("rowspan",C);for(var m=1,l=j;m<C;m++){k[j+m].hide()}};f=false}}var B=this,y=[];q.each(function(){var h=b(this).find("td"+(s?":not("+s+")":""));if(B.p.hasChk){h=h.not("td:first")}y.push(h.eq(x))});var r,t=1,z=0;for(var w=0,u=this.data.length;w<u;w++){var A=this.data[w];if(w!=0&&r===A[g.dataIndex]){t++;if(w==u-1){o(y,z,t)}}else{if(t!=1||(t==1&&w!=0)){o(y,z,t);z=w;t=1}}r=A[g.dataIndex]}}},switchEdit:function(j,z,e,n,y){var g=j.editCell,u=z;for(var w=0,s=g.length;w<s;w++){var f=g[w],q,h=f[0],x=f[1],r=f[2],k=f[4],p=f[5];if(z!=null){q=z}else{q=!r;u=q}if(q){if(!r){h.show();x.hide();f[2]=true;if(!n){h.val(j[f[3]])}}}else{if(r){h.hide();x.show();f[2]=false;if(!e){var m=h.val(),o=m;if(p){o=p[m]}if(!k){x.text(o)}else{x.html(k(o,j,y))}j[f[3]]=m}}}}if(this.p.editSetHeight){this.setMainHeight()}this.fire("afterSwitchEdit",{isEdit:u,rowData:j,rowNum:y})},checkEdit:function(){var n;if(!this.p.isPageCache){n=this.data}else{n=this.datas}for(var h=0,f=n.length;h<f;h++){var k=n[h];if(k.editCell){for(var g=0,e=k.editCell.length;g<e;g++){if(k.editCell[g][2]){return false}}}}return true},isDataEmpty:function(){var f=false;if(!this.p.isPageCache){for(var j=0,g=this.data.length;j<g;j++){if(this.data[j]!=null){f=true;break}}}else{for(var k=0,g=this.pageCache.length;k<g;k++){var n=this.pageCache[k][1];for(var j=0,e=n.length;j<e;j++){if(n[j]!=null){f=true;break}}}}return !f||this.data.length<=0},clearData:function(k){var g=this,h=this.p.noGridBorder;this.data=[];this.data.lengthD=0;this.chks=[];if(this.p.hasGroup){this.rows=[]}this.pageNo=1;this.p.canSort=false;if(this.p.isPageCache){this.clearPageCache()}this.tbody.empty();if(this.p.isLazyLoad){this.lazyRowNo=0}var e=this.getColNum();if(!this.p.isTree&&!this.p.percentWidth){this.table.width(this.tableHead.width()+((c.isIEgt8&&h&&this.p.lockColumn)?(-1*e[0]+2):0)+(c.isIE8?-2:0))}this.tbody.append('<tr emptyRow="true"><td style="text-align:center;height:'+this.p.emptyRowH+'px;">'+(!k?this.p.emptyTxt:"&nbsp;")+"</td></tr>");if(this.p.lockColumn){this.tbody2.empty();this.table2.width(this.tableHead2.width());this.tbody2.append('<tr emptyRow="true"><td style="text-align:center;height:'+this.p.emptyRowH+'px;">&nbsp;</td></tr>');if(this.p.lockColumnR){this.tbody3.empty();this.table3.width(this.tableHead3.width()+((c.isIEgt8&&h)?(-1*e[2]):0));this.tbody3.append('<tr emptyRow="true"><td style="text-align:center;height:'+this.p.emptyRowH+'px;">&nbsp;</td></tr>')}}for(var f=0,j=this.p.columns;f<j.length;f++){if(j[f].isHide){this.hideColumn(f,false,true)}}this.setTableWidth();this.setMainHeight(true);return this},setColumeDD:function(){var h=this;this.colDDs=[];this.spjs=[];for(var g=0,m=this.p.columns,e=m.length;g<e;g++){var k=this.getColType(g);var j=b("<div class='dgj_ddBar noRej'></div>").css({top:0,width:5,height:"100%",backgroundColor:"#fff",opacity:0.001,position:"absolute",zIndex:1,display:b.inArray(g,this.p.hideColumeDD)==-1?"block":"none"}),f;switch(k){case 0:case 1:case 3:this.colDDs.push(j);this.headContainer.append(j);break;case 2:j.addClass("dgj_colDD"+g);f=j.clone();this.lcHeadContainer.append(j);this.lcContainer.append(f);this.colDDs.push([j,f]);break}(function(l,o){switch(k){case 0:var p=b(l).SPJ({ddPosType:h.p.ddPosType,oLeft:h.thds1.eq(o),evts:{splitEnd:function(q,i){var s,r=function(C,u){var z=C.find("div.dgj_tdDiv");if(h.p.hasChk){z=z.not("div:first")}var t=z.eq(o);s=t.attr("mergeCell");if(!s){var y=parseFloat(t.attr("mergeCellN"));if(!y){t.width((h.p.noGridBorder&&o!=0)?i.l+1:i.l)}else{var B=i.l,v=y,A=parseFloat(t.attr("mergeCellH"));for(var x=0;x<A;x++){if(v!=o){B+=h.thds1.eq(v).width()+h.p.mcShift}v--}z.eq(y).width(B)}}else{var B=i.l,v=o;for(var x=0;x<s-1;x++){v--;B+=h.thds1.eq(v).width()+h.p.mcShift}t.width(B)}};h.table.find("tr:not(tr[loading],tr[groupRow])").each(function(t){r(b(this),t)});if(h.p.hasGridFoot){r(h.trF)}c.lazyDo(function(){this.setDDPosition()},100,"ld_dgjScroll",h);h.setSbjWidth(true);h.countFbtnPos();h.setMainHeight();if(h.p.collapseSonRow){h.tbody.find("div.dgj_tdDiv").eq(h.p.hasChkG?1:0).width(h.tableHead.width()-h.p.chkWidth-h.shiftG)}if(!s){h.saveColWidth(o,i.l)}}}});break;case 1:var p=b(l).SPJ({ddPosType:h.p.ddPosType,oLeft:h.thds1.eq(o),evts:{splitEnd:function(q,i){h.table.find("tr:not(tr[loading])").each(function(s){var r=b(this).find("div.dgj_tdDiv");if(h.p.hasChk){r=r.not("div:first")}r.eq(o).width((h.p.noGridBorder&&o!=0)?i.l+1:i.l)});if(!h.p.asyncLoadTree){h.syncRowHeight()}h.setLockWidth();h.setDDPosition();h.sbj.left(h.table.width());h.countFbtnPos();h.setMainHeight();h.saveColWidth(o,i.l)}}});break;case 2:var n=o-h.p.lockColumn+1;var p=b("div.dgj_colDD"+o).SPJ({ddPosType:h.p.ddPosType,oLeft:h.thds2.eq(n),evts:{splitEnd:function(q,i){h.table2.find("tr:not(tr[loading])").each(function(s){var r=b(this).find("div.dgj_tdDiv");r.eq(n).width((h.p.noGridBorder&&n!=0)?i.l+1:i.l)});if(!h.p.asyncLoadTree){h.syncRowHeight()}h.setDDPosition(true);h.setLockWidth();h.setDDPosition();h.countFbtnPos();h.setMainHeight();h.saveColWidth(o,i.l)}}});break;case 3:var n=o-h.p.lockColumnR+1;var p=b(l).SPJ({ddPosType:h.p.ddPosType,oLeft:h.thds3.eq(n),evts:{splitEnd:function(q,i){h.table3.find("tr:not(tr[loading])").each(function(s){var r=b(this).find("div.dgj_tdDiv");r.eq(n).width((h.p.noGridBorder&&n!=0)?i.l+1:i.l)});if(!h.p.asyncLoadTree){h.syncRowHeight()}h.setLockWidth();h.sbj.left(h.table.width());h.setDDPosition();h.countFbtnPos();h.setMainHeight();h.saveColWidth(o,i.l)}}});break}h.spjs.push(p)})(j,g,h)}},setDDPosition:function(t){var q=this;var s=6;if(d.isIElt9){s=7}else{if(d.isIE9||d.isIE10||d.isFF){s=8}else{if(d.isWebkit){s=12}}}for(var o=0,r=this.p.columns;o<r.length;o++){var n=this.getColType(o);if(this.p.lockColumn&&n==1&&t){continue}var h=0;switch(n){case 0:case 1:h=q.ths1.eq(o)[this.p.ddPosType]().left;var e=h+(!d.isWebkit?q.ths1.eq(o).width():q.ths1.eq(o)[0].clientWidth);if(this.p.ddPosType=="offset"){e-=s}if(q.p.canColumeDD){this.colDDs[o].css({left:e})}break;case 2:var m=o-this.p.lockColumn+1;var g=this.sbj.getScrollLeft();h=q.ths2.eq(m)[this.p.ddPosType]().left-(this.p.ddPosType=="offset"?this.tableHead.width():0)+g;var e=h+(!d.isWebkit?q.ths2.eq(m).width():q.ths2.eq(m)[0].clientWidth)-(this.p.ddPosType=="offset"?s:0);if(q.p.canColumeDD){this.colDDs[o][0].css({left:e});this.colDDs[o][1].css({left:e});this.spjs[o].p.shift.l=g}break;case 3:var m=o-this.p.lockColumnR+1;h=q.ths3.eq(m)[this.p.ddPosType]().left;var e=h+(!d.isWebkit?q.ths3.eq(m).width():q.ths3.eq(m)[0].clientWidth);if(this.p.ddPosType=="offset"){e-=s}if(q.p.canColumeDD){this.colDDs[o].css({left:e})}break}if(this.p.canColumeDD){var j=0;if(r[o].minWidth){j=r[o].minWidth}else{j=this.p.defaultMinW}this.spjs[o].p.minX=h+j;if(r[o].maxWidth){this.spjs[o].p.maxX=h+r[o].maxWidth}}}if(this.isDataEmpty()){var f=this.p.noGridBorder,u;if(f){u=this.getColNum()}if(!this.p.percentWidth){this.table.width(this.tableHead.width()+((c.isIEgt8&&f&&this.p.lockColumn)?(-1*u[0]+1):0))}if(this.p.lockColumn){this.table2.width(!d.isFF?this.tableHead2.width():this.tableHead2.width()+1)}if(this.p.lockColumnR){this.table3.width(!d.isFF?this.tableHead3.width()+((c.isIEgt8&&f)?(-1*u[2]):0):this.tableHead3.width()+1)}c.lazyDo(function(){this.syncRowHeightH()},100,"ld_dgjSrhh",this)}},saveColWidth:function(i,g){if(this.p.storeName){try{var j=c.LocalStorage.getItem({key:this.p.storeName+"_colWidth"}),f;if(j){f=JSON.parse(j)}else{f={}}f[i]=g;c.LocalStorage.setItem({key:this.p.storeName+"_colWidth",value:JSON.stringify(f)})}catch(h){}}},setRowWidthG:function(){if(!this.p.isTree&&this.p.collapseSonRow){this.tbody.find("div.dgj_tdDiv").eq(this.p.hasChkG?1:0).width(this.tableHead.width()-this.p.chkWidth-this.shiftG)}},setSbjWidth:function(g){if(this.p.isTree){return}var i=this;var h=this.tableHead.width()+2;var j=this.divOut.width();var f=h;if(!this.p.isTree&&this.p.isAutoSetWidth){this.mainContainer.width(h);this.mainHeadContainer.width(f);if(this.p.hasGridFoot){this.mainFootContainer.width(f)}if(c.isMobile){this.bodyContainer.width(h);this.headContainer.width(f);this.gridContainer.width(f)}}var e=i.bodyContainer[0].scrollWidth;i.sbj.width(j+(!this.p.fbSpace?1:0),e)},setSbjPostionLc:function(){var h=this.gridContainer.width(),g=this.table.width(),f;if(h+(d.isIEgt9?1:0)<this.gridContainer[0].scrollWidth){var e=this.lcHeadContainer.width(),i=this.gridContainer[0].scrollLeft;if(h+i-g-e<0){f=h-this.sbj.divOut.width()}else{if(i>g){f=0}else{f=g-i}}}else{f=g}this.sbj.left(f)},setLockWidth:function(){var i=this;var f=0;if(!i.p.lockColumnR){f=i.divOut.width()-i.tableHead.width()-18}else{f=i.divOut.width()-i.tableHead.width()-18-i.tableHead3.width()}var e=f,j=f;if(d.isFF){e=f-6;j=f-6}else{if(d.isWebkit){e=f-2;j=f-2}}var l=i.tableHead2.width();if(l>0&&l<f){var h=this.p.lockColumnR?1:0;e=l-h;j=l-h}else{if(l<=0){e=0;j=0}}var g=e<this.p.lcMinWidth;if(g){j=e=this.p.lcMinWidth}i.lcHeadContainer.width(e);var k=i.lcContainer;k.width(j);if(g){wG=this.mainContainer.width()+this.lcHeadContainer.width();if(this.p.lockColumnR){wG+=!(c.isIElt8)?this.rightContainer.width():this.tableHead3.width()}this.headContainer.width(wG+(this.p.noGridBorder?1:0));this.bodyContainer.width(wG+18);this.gridContainer.css("overflow-x","auto")}else{this.headContainer.css("width","auto");this.bodyContainer.css("width","auto");this.gridContainer.css("overflow-x","hidden")}this.sbj.width(k.width()+(this.p.noGridBorder?3:2),k[0].scrollWidth+(!this.p.lockColumnR?3:0));this.fire("afterSetWidth")},setTableWidth:function(x,r,e){var z=this;var t=this.isDataEmpty();if(!this.p.lockColumn){if(!r&&!this.p.isTree&&this.p.isAutoSetWidth){var l=this.divOut.width();var g=this.tableHead.width();var q=l-g;var v=0,p=0,n=0;var k=this.p.fbSpace?18:2;var A,s,o=function(B,w){var C;if(w){C=z.thds}else{C=B.find("div.dgj_tdDiv");if(this.p.hasChk){C=C.not("div:first")}}if(this.columnP!=null){v=this.columnP}else{v=C.length-1}var h=C.eq(v);A=h.attr("mergecell");if(A){s=C}p=h.width();n=q+p-k;if(n>this.p.defaultW){h.width(n)}else{h.width(this.p.defaultW)}};o.call(this,this.tableHead,true);if(this.p.hasGridFoot){o.call(this,this.tableFoot)}var f=0;if(A){for(var u=1,j=this.p.columns;u<A;u++){var m=s.eq(v-u),y=j[v-u];f+=parseInt(m[0].style.width,10)+(!y.editable?4:6)+(z.p.noGridBorder?1:0)}}this.table.find("tr.dgj_tr1").each(function(){var C=b(this).find("div.dgj_tdDiv");if(z.p.hasChk){C=C.not("div:first")}var w=C.eq(v);var B=w.width();var h=q+p-k;if(h>z.p.defaultW){w.width(n-f)}else{w.width(z.p.defaultW-f)}})}this.setSbjWidth();if(this.p.canColumeDD){this.setDDPosition();if(d.isIElt8){this.gridContainer.css("position","static").css("position","relative")}}this.setRowWidthG()}else{this.setLockWidth();if(this.p.canColumeDD){this.setDDPosition()}this.setSbjPostionLc();this.countFbtnPos();if(!x){c.lazyDo(function(){this.syncRowHeight()},100,"ld_dgjSrh",this)}}if(!this.p.isTree){if(t){var i=this.p.noGridBorder;if(i&&e==null){e=this.getColNum()}if(!this.p.percentWidth){this.table.width(this.tableHead.width()+((c.isIEgt8&&i&&this.p.lockColumn)?(-1*e[0]+1):0)+(c.isIE8?-2:0))}if(this.p.lockColumn){this.table2.width(this.tableHead2.width())}if(this.p.lockColumnR){this.table3.width(this.tableHead3.width()+((c.isIEgt8&&i)?(-1*e[2]):0))}}else{if(!this.p.percentWidth){this.table.css("width","auto")}if(this.p.lockColumn){this.table2.css("width","auto")}if(this.p.lockColumnR){this.table3.css("width","auto")}}}},setMainHeight:function(j){if(this.p.borderWidth&&!this.p.lockColumn){if(j==null){j=this.isDataEmpty()}if(this.p.noGridBorder){if(j){this.table.css({borderRightWidth:0,borderBottomWidth:0})}else{this.table.css({borderRightWidth:1,borderBottomWidth:1})}}else{var f=this.table.find("td");if(j){f.css("border-width",0)}else{f.css("border-width",1)}}}var g=(!this.p.hideScrollH&&!this.p.isTree&&(this.p.isReservedSbjH||this.sbj.hasScrollH()))?this.sbj.p.height:0;if(g==0){this.sBarHContainer.hide()}else{this.sBarHContainer.show()}if(!this.p.isAutoSetHeight){this.bodyContainer.css("height","auto");if(c.isIEgt9){this.gridContainer.css("height","auto")}return}var n=this.divOut.parent().height();var p=this.headContainer.height();var e=this.table.height();var q=0;if(this.p.hasGridFoot){q=this.tableFoot.height()}if(this.p.lockColumn){var k=this.table2.height();var i=0;if(this.p.lockColumnR){i=this.table3.height()}var o=Math.max(e,k,i);e=o}var m=p+e+q+g;if(m>=n){var l=n-p-q-g;if(this.p.lockColumn){if(!(c.isIElt8)&&this.gridContainer.width()+(d.isIEgt9?1:0)<this.gridContainer[0].scrollWidth){l-=g}if(d.isIEgt9){this.gridContainer.height(n-g)}}if(this.p.borderWidth){l-=1;if(!this.p.lockColumn){var r;if(this.p.noGridBorder){r=this.table}else{r=this.table.find("tr:last > td")}r.css("border-bottom-width",0)}}this.bodyContainer.height(l)}else{if(this.p.lockColumn){if(d.isIEgt9){if(this.gridContainer.width()+1<this.gridContainer[0].scrollWidth){this.gridContainer.height(m)}else{this.gridContainer.height(m-g+(this.p.noGridBorder?1:0))}}}if(this.p.borderWidth&&!this.p.lockColumn&&!j){var r;if(this.p.noGridBorder){r=this.table}else{r=this.table.find("tr:last > td")}r.css("border-bottom-width",1)}this.bodyContainer.height((!this.p.isTree?e+(!this.p.hasGridFoot?(c.isFF&&this.p.isTree?2:1):(d.isFF?0:-1)):n)+(this.p.noGridBorder?1:0))}},reLayout:function(f,e){this.setTableWidth(f,e);this.countFbtnPos();this.setMainHeight();this.autoLoadlazyRow()},syncRowHeight:function(){var e=this;if(this.p.lockColumn){this.syncRowHeightH();this.syncRowHeightB()}},syncRowHeightR:function(e,j,i,h){if(this.p.lockColumn){var m,g;if(!j){m=this.tbody.find("tr:not(tr[loading])").eq(e);g=this.tbody2.find("tr:not(tr[loading])").eq(e)}else{m=j;g=i}var n=m.height();var l=g.height();var o,f,k;if(!this.p.lockColumnR){o=Math.max(n,l)}else{if(!j){f=this.tbody3.find("tr:not(tr[loading])").eq(e)}else{f=h}k=f.height();o=Math.max(n,l,k);f.height(o)}m.height(o);g.height(o)}},syncRowHeightH:function(){if(this.p.lockColumn){if(!this.columnGroup){var h=this.trH.height(),g=this.trH2.height(),e,f;if(!this.p.lockColumnR){e=Math.max(h,g)}else{f=this.trH3.height();e=Math.max(h,g,f);this.trH3.height(e)}this.trH.height(e);this.trH2.height(e)}else{var i=(c.isIE8||c.isIE9||c.isIE10||c.isWebkit)?1:0,h=this.tableHead.height(),g=this.tableHead2.height(),e,f;if(!this.p.lockColumnR){e=Math.max(h,g)}else{f=this.tableHead3.height();e=Math.max(h,g,f);if(e>f){if(this.hasCg3){this.trHcg3.height(e-this.trH3.height()-i)}else{this.trH3.height(e-i)}}}if(e>h){if(this.hasCg1){this.trHcg.height(e-this.trH.height()-i)}else{this.trH.height(e-i)}}if(e>g){if(this.hasCg2){this.trHcg2.height(e-this.trH2.height()-i)}else{this.trH2.height(e-i)}}}}},syncRowHeightB:function(){var g=this;if(this.p.lockColumn){var f=this.tbody2.find("tr:not(tr[loading])"),e;if(this.p.lockColumnR){e=this.tbody3.find("tr:not(tr[loading])")}this.tbody.find("tr:not(tr[loading])").each(function(n){var l=b(this);var o=f.eq(n);var k=l.height();var j=o.height();var h,m,i;if(!g.p.lockColumnR){h=Math.max(k,j)}else{m=e.eq(n);i=m.height();h=Math.max(k,j,i);m.height(h)}l.height(h);o.height(h)})}},countFbtnPos:function(){if(this.p.hasFloatBtn&&!this.p.borderWidth){var e=this.headContainer.width(),i=this.mainHeadContainer.width(),j=this.p.lockColumn?this.lcHeadContainer.width():0,g=this.p.lockColumnR?this.rightHeadContainer.width():0,f=e-i-j-g-15,h=f>=0?f:0;this.floatBtn.css("right",h)}},setRowHL:function(f){if(!this.p.isRowHighlight){return}var e=this;f.unbind("mouseenter").unbind("mouseleave").hover(function(){var i=e.p.colorParams.highlight,h=c.theme.configDgj;var g=!i?h.highlight:i;if(f.attr("rownum")){g=h.highlightG}if(e.hasAnimateHl){f.animate({backgroundColor:g},50,function(){f.css("background-color",g)})}else{f.css("background-color",g)}},function(){var g=f.attr("spRowColor"),h;if(!g||f.attr("selected")){h=f.attr("colorT");if(h){g=c.theme.configDgj[h]}else{g=f.attr("colorBg")}}if(e.hasAnimateHl){f.stop().animate({backgroundColor:g},200,function(){e.resumeHL(g,h,f)})}else{e.resumeHL(g,h,f)}})},resumeHL:function(e,f,g){if(f){g.each(function(){this.style.backgroundColor=""})}else{g.css("background-color",e)}},setRowColor:function(j,h,g,f,i){if(this.p.hasSelectColor&&h.attr("selected")){return}var l=this.p.colorParams,e=h.attr("spRowColor"),k=l.selectColor;if(j&1){if(!e&&k){e=l.trColor2}if(!e){h.swapClassJ("dgj_oddTr dgj_selectedTr","dgj_evenTr").attr({colorT:"even",colorTY:"even"})}else{h.css("background-color",e).attr({colorBg:e,colorBgY:e})}if(this.p.lockColumn){if(!e){g.swapClassJ("dgj_oddTr dgj_selectedTr","dgj_evenTr").attr({colorT:"even",colorTY:"even"})}else{g.css("background-color",e).attr({colorBg:e,colorBgY:e})}}if(this.p.lockColumnR){if(!e){f.swapClassJ("dgj_oddTr dgj_selectedTr","dgj_evenTr").attr({colorT:"even",colorTY:"even"})}else{f.css("background-color",e).attr({colorBg:e,colorBgY:e})}}}else{if(!e&&k){e=l.trColor1}if(!e){h.swapClassJ("dgj_evenTr dgj_selectedTr","dgj_oddTr").attr({colorT:"odd",colorTY:"odd"})}else{h.css("background-color",e).attr({colorBg:e,colorBgY:e})}if(this.p.lockColumn){if(!e){g.swapClassJ("dgj_evenTr dgj_selectedTr","dgj_oddTr").attr({colorT:"odd",colorTY:"odd"})}else{g.css("background-color",e).attr({colorBg:e,colorBgY:e})}}if(this.p.lockColumnR){if(!e){f.swapClassJ("dgj_evenTr dgj_selectedTr","dgj_oddTr").attr({colorT:"odd",colorTY:"odd"})}else{f.css("background-color",e).attr({colorBg:e,colorBgY:e})}}}if(i&&this.p.hasSelectColor){this.setRowColorSelected(h,g,f)}},setRowColorG:function(g,e,f){if(this.p.hasSelectColor&&e.attr("selected")||e.attr("spRowColor")){return}var h=this.p.colorParams.selectColor;if(g&1){if(this.p.colorParams.groupRow2&&h){e.css("background-color",this.p.colorParams.groupRow2).attr("colorBgY",this.p.colorParams.groupRow2)}else{e.removeClass("dgj_oddTrG dgj_selectedTr").addClass("dgj_evenTrG").attr("colorT","evenG").attr("colorTY","evenG")}}else{if(this.p.colorParams.groupRow&&h){e.css("background-color",this.p.colorParams.groupRow).attr("colorBgY",this.p.colorParams.groupRow)}else{e.removeClass("dgj_evenTrG dgj_selectedTr").addClass("dgj_oddTrG").attr("colorT","oddG").attr("colorTY","oddG")}}if(f&&this.p.hasSelectColor){this.setRowColorSelected(e)}},setRowColorSelected:function(h,g,f){var e=this.p.colorParams.selectColor,i=this.p.colorParams.groupRow;h.attr("selected",true);if(!e&&!i){if(this.p.hasGroup){h.removeClass("dgj_oddTrG dgj_evenTrG")}h.removeClass("dgj_oddTr dgj_evenTr").addClass("dgj_selectedTr").attr("colorT","selected")}else{h.css("background-color",this.p.colorParams.selectColor).attr("colorBg",this.p.colorParams.selectColor)}if(this.p.lockColumn){g.attr("selected",true);if(!e&&!i){if(this.p.hasGroup){g.removeClass("dgj_oddTrG dgj_evenTrG")}g.removeClass("dgj_oddTr dgj_evenTr").addClass("dgj_selectedTr").attr("colorT","selected")}else{g.css("background-color",this.p.colorParams.selectColor).attr("colorBg",this.p.colorParams.selectColor)}}if(this.p.lockColumnR){f.attr("selected",true);if(!e&&!i){if(this.p.hasGroup){f.removeClass("dgj_oddTrG dgj_evenTrG")}f.removeClass("dgj_oddTr dgj_evenTr").addClass("dgj_selectedTr").attr("colorT","selected")}else{f.css("background-color",this.p.colorParams.selectColor).attr("colorBg",this.p.colorParams.selectColor)}}},setColorCheckOne:function(k,n,l){var e=k.find("tr[selected]");var o=e.attr("colorBgY"),i=e.attr("spRowColor"),h=e.attr("colorTY"),m=this.p.hasGroup?"G":"";var p;if(h){p=h.indexOf("G")==-1?h:h.substr(0,h.length-1)}if(i){o=i}if(e.length>0){e.removeAttr("selected");if(o){e.css("background-color",o).attr("colorBg",o)}else{if(this.p.hasGroup){e.removeClass("dgj_oddTrG dgj_evenTrG")}e.removeClass("dgj_selectedTr dgj_oddTr dgj_evenTr").addClass("dgj_"+p+"Tr"+m).attr("colorT",h)}}if(this.p.lockColumn){var j=n.find("tr[selected]");if(j.length>0){j.removeAttr("selected");if(o){j.css("background-color",o).attr("colorBg",o)}else{if(this.p.hasGroup){j.removeClass("dgj_oddTrG dgj_evenTrG")}j.removeClass("dgj_selectedTr dgj_oddTr dgj_evenTr").addClass("dgj_"+p+"Tr"+m).attr("colorT",h)}}}if(this.p.lockColumnR){var f=l.find("tr[selected]");if(f.length>0){f.removeAttr("selected");if(o){f.css("background-color",o).attr("colorBg",o)}else{if(this.p.hasGroup){f.removeClass("dgj_oddTrG dgj_evenTrG")}f.removeClass("dgj_selectedTr dgj_oddTr dgj_evenTr").addClass("dgj_"+p+"Tr"+m).attr("colorT",h)}}}},setSpRowColor:function(i,f,e){var h=this;var g=function(j){j.css("background-color",h.p.colorParams.spRowColor).attr("spRowColor",h.p.colorParams.spRowColor)};g(i);if(this.p.lockColumn){g(f)}if(this.p.lockColumnR){g(e)}},collapseAnimWrap:function(o,l,e,g){var j=this;var m,f,i;var k=this.p.columns.length;m=b("<tr><td colspan='"+((this.p.hasChk||this.p.hasChkG)?k+1:k)+"' style='padding:0;border-top-width:0;border-right-width:0;border-bottom-width:0;'></td></tr>");f=b("<div class='dgj_trTd' style='padding:0;margin:0;'></div>");var n=b("<table style='margin:"+(!this.p.isTree?"-1px 0 0 -1px":"0")+";'><tbody></tbody></table>");f.append(n);n.find("tbody").append(e);m.find("td").append(f);l.after(m);if(o){if(d.isIElt8){e.show()}else{e.css("display","table-row")}this.setMainHeight();i=f.height()-2;f.height(0).animate({height:b.easing.easeOutQuad&&this.p.easing?[i,this.p.easing]:i},this.p.collapseSpeed,function(){l.after(e);m.remove();d.lazyDo(function(){if(!c.isMobile){this.setTableWidth()}this.setMainHeight();if(g){g.call(this)}},50,"ld_dgjCSR",j)})}else{i=f.height()-2;f.height(i).animate({height:b.easing.easeOutQuad&&this.p.easing?[0,this.p.easing]:0},this.p.collapseSpeed,function(){l.after(e);m.remove();e.hide();d.lazyDo(function(){if(!c.isMobile){this.setTableWidth()}this.setMainHeight();if(g){g.call(this)}},50,"ld_dgjCSR",j)})}},setRowSelect:function(f,e){if(!e.selected){e.selected=true;f.css({backgroundColor:this.p.colorParams.select}).attr("colorBgO",f.attr("colorBg")).attr("colorBg",this.p.colorParams.select)}else{e.selected=false;f.css({backgroundColor:f.attr("colorBgO")}).attr("colorBg",f.attr("colorBgO"))}},check:function(F,i,q,E,J,e,v,s){var I=this,i=i,E=E,B=true,o,y,x,D,m=!e,H=e,k=v,j=s,C=false,r=this.p.isTreeGrid,w=this.p.hasGroup;if(r){if(d.RX.numZ(F)){F=F+"."}}if(!i){if(!r){i=this.data[F]}else{i=this.seekNode(F)}}else{if(!r&&!w){F=b.inArray(i,this.data)}}if(!E){B=false;if(!r){E=this.chks[F]}else{E=i[this.p.nodeChkField]}}if(!q){q={}}if(!H){H=this.tbody}if(!k){k=this.tbody2}if(!j){j=this.tbody3}if(w){D=F+(!J?"":("_"+J))}if(this.p.hasSelectColor){if(!this.oTrsChkAll1){var f;if(!w){if(!r){f="tr:not(tr[loading],tr[emptyRow]):eq("+F+")"}else{f="tr[path='"+F+"']"}}else{f="tr[rowNum="+D+"]"}o=H.find(f);if(this.p.lockColumn){y=k.find(f)}if(this.p.lockColumnR){x=j.find(f)}}else{if(!w){if(!r){o=this.oTrsChkAll1.eq(F)}else{o=this.oTrsChkAll1.filter("tr[path='"+F+"']")}}else{o=this.oTrsChkAll1.filter("[rowNum="+D+"]")}if(this.p.lockColumn){if(!r){y=this.oTrsChkAll2.eq(F)}else{y=this.oTrsChkAll2.filter("tr[path='"+F+"']")}}if(this.p.lockColumnR){if(!r){x=this.oTrsChkAll3.eq(F)}else{x=this.oTrsChkAll3.filter("tr[path='"+F+"']")}}}}if(B&&!q.isAllCheck&&E[0].checked==i.checked&&!q.isClickRow){return}if(i){var g,u;if(this.p.collapseSonRow){g=H.find("tr[rowNum="+D+"]");u=H.find("tr.dgj_trB_"+D)}if(i.checked){if(this.p.isCheckOne){this.selectedItem=null}if(!B){if(this.p.chkStyle){E.sbxj.setChecked(false,null,true)}else{E[0].checked=false}}i.checked=false;if(this.p.hasSelectColor&&o){o.removeAttr("selected");if(this.p.lockColumn){y.removeAttr("selected")}if(this.p.lockColumnR){x.removeAttr("selected")}if(!w){this.setRowColor(!r?F:0,o,y,x)}else{this.setRowColorG(F,o)}}if(this.p.collapseSonRow){g.removeAttr("collapse");if(this.p.collapseAnimate&&!q.isAllCheck){this.collapseAnimWrap(false,g,u);C=true}else{u.hide()}if(m){this.autoLoadlazyRow(null,200)}}}else{if(this.p.isCheckOne){if(!this.p.isPageCache){if(this.p.hasSelectColor){this.setColorCheckOne(this.tbody,this.p.lockColumn?this.tbody2:null,this.p.lockColumnR?this.tbody3:null)}}else{for(var z=0,t=this.pageCache.length;z<t;z++){if(this.p.hasSelectColor){var e=this.pageCache[z][2];var v=this.pageCache[z][4];var s=this.pageCache[z][5];this.setColorCheckOne(e,v,s)}}}if(this.p.collapseSonRow){var A=this.table.find("tr[collapse=true]");if(A.length>0){this.table.find("tr.dgj_trB_"+A.attr("rowNum")).hide();A.removeAttr("collapse")}}var G=this.selectedItem;if(G){if(this.p.chkStyle){G.chk.sbxj.setChecked(false,null,true)}else{G.chk[0].checked=false}G.data.checked=false}this.selectedItem={chk:E,data:i}}if(!B){if(this.p.chkStyle){E.sbxj.setChecked(true,null,true)}else{E[0].checked=true}}i.checked=true;if(this.p.hasSelectColor&&o){this.setRowColorSelected(o,y,x)}if(this.p.collapseSonRow){g.attr("collapse",true);if(this.p.collapseAnimate&&!q.isAllCheck){this.collapseAnimWrap(true,g,u);C=true}else{if(d.isIElt8){u.show()}else{u.css("display","table-row")}}}}if(this.p.collapseSonRow&&m&&!C){d.lazyDo(function(){this.setMainHeight()},50,"ld_dgjCSR",this)}var n;if(w){if(u&&u.length>0){n=u.eq(u.length-1)}else{n=g}}if(!q.isAllCheck){this.fire("checkedOne",{rowData:i,rowNo:F,checked:i.checked,pageNo:J,lastTr:n})}}},fnChkAll:function(e,k,f){var j=true;if(e){j=e.checked}else{if(k!=null){j=k;if(this.p.chkStyle){this.sbxjAll.setChecked(j,null,true)}else{this.chkAll[0].checked=j}}}var g;if(this.p.hasSelectColor){if(!this.p.hasGroup){g="tr:not(tr[loading],tr[emptyRow])"}else{g="tr[rowNum]"}}if(!f||!this.p.isPageCache){this.checkAllFn(this.data,this.chks,this.tbody,this.p.lockColumn?this.tbody2:null,this.p.lockColumnR?this.tbody3:null,g,j);this.initTrsChkAll()}else{for(var h=0;h<this.pageCache.length;h++){this.checkAllFn(this.pageCache[h][1],this.pageCache[h][3],this.pageCache[h][2],this.pageCache[h][4],this.pageCache[h][5],g,j)}this.initTrsChkAll()}},checkAll:function(f,e){this.fnChkAll(null,f,e)},checkAllFn:function(m,o,h,g,f,n,s){if(this.p.hasSelectColor){this.oTrsChkAll1=h.find(n);if(this.p.lockColumn){this.oTrsChkAll2=g.find(n)}if(this.p.lockColumnR){this.oTrsChkAll3=f.find(n)}}for(var k=0,i=o.length;k<i;k++){var q=o[k];if(q){var e=q[0].checked;if(s?!e:e){var r={isAllCheck:true};q[0].paramJ=r;q.trigger("click",r)}}}if(this.p.isLazyLoad){for(var k=0,i=m.length;k<i;k++){var p=m[k];if(p){p.checked=s}}}},initTrsChkAll:function(){if(this.p.hasSelectColor){this.oTrsChkAll1=null;if(this.p.lockColumn){this.oTrsChkAll2=null}if(this.p.lockColumnR){this.oTrsChkAll3=null}}},setDefaultChkAll:function(){if(this.p.chkStyle){this.sbxjAll.setChecked(true,null,true)}else{this.chkAll[0].checked=true}for(var f=0,e=this.data.length;f<e;f++){this.data[f].checked=true}},sort:function(B,r,s,D,t){var C=this;if(!D||D.length<=1){return}var w=this.p.hasGroup;for(var x=0,u=D.length;x<u;x++){D[x].sortNo=x}c.Sort.execute(D,s,B,this.p.noSortSp);if(!w&&this.p.hasChk){var h=[];for(var x=0,u=D.length;x<u;x++){var z=this.chks[D[x].sortNo];h.push(z)}this.chks.length=0;for(var x=0,u=h.length;x<u;x++){this.chks.push(h[x])}}var g=this.pageNo!=null?"_"+this.pageNo:"";var v=!w?"tr.dgj_tr1:not(tr[loading])":"tr.dgj_trB_"+t+g;var q=this.tbody.find(v),m,k,e,A,y;if(this.p.lockColumn){m=this.tbody2.find(v.replace(/dgj_tr1/g,"dgj_tr2"))}if(this.p.lockColumnR){k=this.tbody3.find(v.replace(/dgj_tr1/g,"dgj_tr3"))}if(!w){var j=document.createDocumentFragment(),p,n;if(this.p.lockColumn){p=document.createDocumentFragment()}if(this.p.lockColumnR){n=document.createDocumentFragment()}for(var x=0,u=D.length;x<u;x++){var f;e=q.eq(D[x].sortNo);j.appendChild(e[0]);if(this.p.lockColumn){A=m.eq(D[x].sortNo);p.appendChild(A[0])}if(this.p.lockColumnR){y=k.eq(D[x].sortNo);n.appendChild(y[0])}this.setRowColor(x,e,A?A:null,y?y:null)}this.tbody[0].appendChild(j);if(this.p.lockColumn){this.tbody2[0].appendChild(p)}if(this.p.lockColumnR){this.tbody3[0].appendChild(n)}}else{var o=this.tbody.find("tr.dgj_trGB_"+t+g);var j=document.createDocumentFragment();for(var x=0,u=D.length;x<u;x++){var e=q.eq(D[x].sortNo);j.appendChild(e[0]);this.setRowColor(x,e)}c.Dom.insertAfter(j,o[0])}},sortT:function(n,q,k){var m=this;if(!k||k.length<=1){return}c.Sort.execute(k,q,n,this.p.noSortSp);var o=document.createDocumentFragment(),f,e,g;if(this.p.lockColumn){f=document.createDocumentFragment()}if(this.p.lockColumnR){e=document.createDocumentFragment()}for(var j=0,h=k.length;j<h;j++){g=k[j][this.p.nodePathField];this.tbody.find("tr[path^='"+g+"']").each(function(){o.appendChild(this)});if(this.p.lockColumn){this.tbody2.find("tr[path^='"+g+"']").each(function(){f.appendChild(this)})}if(this.p.lockColumnR){this.tbody3.find("tr[path^='"+g+"']").each(function(){e.appendChild(this)})}}this.tbody[0].appendChild(o);if(this.p.lockColumn){this.tbody2[0].appendChild(f)}if(this.p.lockColumnR){this.tbody3[0].appendChild(e)}},fnSort:function(k,q,m,n){var e=q.attr("sortAsc"),o;if((n!=null&&n)||(n==null&&(!e||e=="false"))){q.swapClassJ("dgj_sortDesc","dgj_sortAsc").attr("sortAsc","true");o=true}else{q.swapClassJ("dgj_sortAsc","dgj_sortDesc").attr("sortAsc","false");o=false}q.css("display","inline");var f={isAsc:o,colNo:k,col:m,colName:m.dataIndex};this.fire("preOnSort",f);if(!this.p.isCustomSort){if(this.p.isTreeGrid){this.sortT(o,m.dataIndex,this.data)}else{if(this.p.hasGroup){for(var h=0,g=this.data.length;h<g;h++){this.sort(o,k,m.dataIndex,this.data[h][this.p.sonRowName],h)}}else{this.sort(o,k,m.dataIndex,this.data)}}}else{this.fire("onSorting",f)}this.fire("finOnSort",f)},sortGrid:function(f,e){if(e==null){e=true}this.fnSort(f,this.gridContainer.find("img[no='sortImg"+f+"']"),this.p.columns[f],e)},setCellSort:function(g,l,k,j,f){var h=this,e=b('<img class="dgj_sortImg" no="sortImg'+g+'" src="'+c.imgPath+'Datagrid/treegrid/s.gif" />');j.append(e);if(!f){j.addClass("dgj_tdSort");k.css("cursor","pointer")}k.attr("title","点击排序").click(function(){h.hideSortImg();if(h.p.isLazyLoad){if(!(h.lazyRowNo>h.data.length-1)){if(h.useMbj){MBJ.loading("提示","正在排序中,请稍候...",function(){var i=this;setTimeout(function(){h.autoLoadlazyRow(true);h.fnSort(g,e,l);i.close()},100)});return}else{h.autoLoadlazyRow(true)}}}if(h.p.sortLoading){if(h.useMbj&&!h.p.evts.beforeSortLoading){MBJ.loading("提示","正在排序中,请稍候...",function(){var i=this;setTimeout(function(){h.fnSort(g,e,l);i.close()},100)})}else{h.fire("beforeSortLoading");setTimeout(function(){h.fnSort(g,e,l);h.fire("afterSortLoading")},100)}}else{h.fnSort(g,e,l)}})},hideSortImg:function(){this.gridContainer.find("img.dgj_sortImg").removeClass("dgj_sortAsc dgj_sortDesc")},remove:function(){this.fire("beforeRemove","DGJ");if(this.p.hasFloatBtn){this.mujFbtn.remove()}if(this.p.hasRowContextMenu){this.rowCmj.remove()}this._super()},getColType:function(e){var f=1;if(!this.p.lockColumn){f=0}else{if(e<this.p.lockColumn-1){f=1}else{if(this.p.lockColumnR){if(e>=this.p.lockColumnR-1){f=3}else{f=2}}else{f=2}}}return f},getColNum:function(){var g=0,f,e;if(!this.p.lockColumn){g=this.p.columns.length}else{g=this.p.lockColumn-1;if(this.p.lockColumn){f=this.p.columns.length-this.p.lockColumn+1}if(this.p.lockColumnR){e=this.p.columns.length-this.p.lockColumnR+1}}if(this.p.hasChk){g+=1}return[g,f,e]},getColSum:function(){var e=0;for(var f=0,e=this.p.columns.length;f<e;f++){if(!this.p.columns[f].isHide){e++}}return e},getHideCols:function(){var g=[];for(var f=0,e=this.p.columns.length;f<e;f++){if(this.p.columns[f].isHide){g.push(f)}}return g},setScrollTop:function(){this.bodyContainer.scrollTop(0)},setScrollBottom:function(){this.bodyContainer.scrollTop(this.bodyContainer[0].scrollHeight)},alert:function(f,e){if(this.useMbj){if(e==null){e="提示"}MBJ.alert(e,f)}else{alert(f)}},fnFullScreen:function(){if(this.p.canFullScreen&&DGJ.onFullScreen){DGJ.onFullScreen.call(this);var f=this.btnFs.find("td:eq(1) div"),g,e;if(this.btnFsCmj){g=this.btnFsCmj.find("td:eq(1) div")}if(!this.isFullScreen){this.isFullScreen=true;e="退出全屏"}else{this.isFullScreen=false;e="全屏显示"}f.text(e);if(this.btnFsCmj){g.text(e)}}},getRowsData:function(l){var k,j=this;if(!l){k=this.data}else{k=l}if(k&&k.length>0&&this.p.hasGroup){var f=[];var i=function(p){for(var n=0,h=p.length;n<h;n++){if(p[n]!=null&&p[n][j.p.sonRowName]!=null){for(var m=0;m<p[n][j.p.sonRowName].length;m++){var q=p[n][j.p.sonRowName][m];for(var r in p[n]){if(r!=j.p.sonRowName){q[r]=p[n][r]}}f.push(q)}}}};if(!this.p.isPageCache){i(k)}else{for(var g=0,e=this.pageCache.length;g<e;g++){i(this.pageCache[g][1])}}return f}else{return null}},fnTbd:function(h,e,f){sp=" ",thiz=this;if(f){sp=f}h.find("div.dgj_tdDiv:visible").each(function(l){var k=b(this),j,n=k.attr("editable"),o=thiz.p.hasChk&&l==0;if(!n){j=k.text()}else{j=k.find("span[editable]").text()}if(f&&j.indexOf(",")!=-1){j=j.replace(/,/g,thiz.p.csvDot)}if(!n){var m=k.find("input[type=text]");if(j!==""||m.length>0){if(m.length>0){m.each(function(){var i=m.val();if(f&&i.indexOf(",")!=-1){i=i.replace(/,/g,thiz.p.csvDot)}j+=" "+i})}e+=sp+j}else{if(!o){e+=sp+" "}}}else{if(j!==""){e+=sp+j}else{if(!o){e+=sp+" "}}}});if(e.indexOf(this.nbspJ)!=-1){var g=c.execJS("/"+this.nbspJ+"/ig");e=e.replace(g," ")}return e},fnTbdQ:function(n,e,j){sp=" ",thiz=this;if(j){sp=j}var g=this.p.exportCol;if(g){for(var h=0,f=g.length;h<f;h++){e=this.fnTbdR(n[g[h]]+"",e,j,sp)}}else{for(var m in n){e=this.fnTbdR(n[m]+"",e,j,sp)}}if(e.indexOf(this.nbspJ)!=-1){var k=c.execJS("/"+this.nbspJ+"/ig");e=e.replace(k," ")}return e},fnTbdR:function(f,e,g,h){if(g&&f.indexOf(",")!=-1){f=f.replace(/,/g,thiz.p.csvDot)}if(f.indexOf("\r\n")!=-1){f=f.replace(/\r\n/g,"")}if(f!==""){e+=h+f}else{e+=h+" "}return e},getGridText:function(q){var n=this,p="",e,h,o=this.exportCol,r=this.p.filterTag?",tr["+this.p.filterTag+"]":"";if(q&&!n.p.isTree){for(var m=0,g=n.p.columns.length;m<g;m++){var f=n.p.columns[m];if(!f.isHide&&(!o||o[f.dataIndex])){p+=","+f.text}}p=p.substr(1)+"\n"}if(n.p.isTreeGrid){h="    ";if(n.p.isTree){h=","}}if(!n.p.hasGroup){if(!this.p.quickRenderMode){e="tr:not(tr[loading],tr[groupRow],tr[emptyRow]"+r+"):visible";n.tbody.find(e).each(function(t){var u=b(this);if(q||((!n.p.isTreeGrid&&u.find("td[chkCell] input:checked").length>0)||u.attr("pasteRow"))){var l="";l=n.fnTbd(u,l,q?",":null);if(n.p.lockColumn){l=n.fnTbd(n.tbody2.find(e+":eq("+t+")"),l,q?",":null)}if(n.p.lockColumnR){l=n.fnTbd(n.tbody3.find(e+":eq("+t+")"),l,q?",":null)}l=l.substr(1);if(q&&n.p.isTreeGrid){var s=parseInt(u.attr("deep"),10);for(var t=0;t<s;t++){l=h+l}}p+=l+"\n"}})}else{var k=this.data;for(var m=0,g=k.length;m<g;m++){var j="";j=n.fnTbdQ(k[m],j,q?",":null);j=j.substr(1);p+=j+"\n"}}}else{e="tr:not(tr[loading],tr[emptyRow],tr[rowno]"+r+")";n.tbody.find(e).each(function(s){var t=b(this);if(q||(t.find("td[chkCellG] input:checked").length>0||t.attr("pasteRowG"))){var l="";l=n.fnTbd(t,l,q?",":null);l=l.substr(1);p+=l+"\n";n.tbody.find("tr.dgj_trB_"+t.attr("rownum")).each(function(){var i="";var u=b(this);i=n.fnTbd(u,i,q?",":null);i=i.substr(1);p+=i+"\n"})}})}return p},hasChecked:function(){var h=!this.p.isPageCache?this.data:this.datas;for(var f=0,e=h.length;f<e;f++){var g=h[f];if(g.checked){return true}}return false},getRowNoL:function(){var e;if(!this.p.compatibleMode){e=this.lazyRowNo+(this.data.lengthC-this.data.length)}else{e=this.lazyRowNo}return e}});d.Image.preLoad(d.imgPath+"Pagination/refresh.gif");b.fn.extend({DatagridJ:function(e){if(this&&this.length>0){return new d.DatagridJ(this,c.DGJ_commonConfig?b.extend(true,c.clone(c.DGJ_commonConfig),e):e)}},DGJ:function(e){return b(this).DatagridJ(e)}})});